<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>å¤šçº¿ç¨‹ | è¿›é˜¶ä¹‹è·¯</title>
    <meta name="generator" content="VuePress 1.8.0">
    
    <meta name="description" content="æ¶æ„å¸ˆ">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/docs.advanced.way/assets/css/0.styles.b15a9a47.css" as="style"><link rel="preload" href="/docs.advanced.way/assets/js/app.dccd45fc.js" as="script"><link rel="preload" href="/docs.advanced.way/assets/js/6.9e0d7fea.js" as="script"><link rel="preload" href="/docs.advanced.way/assets/js/2.714d8455.js" as="script"><link rel="preload" href="/docs.advanced.way/assets/js/11.dd654c6c.js" as="script"><link rel="prefetch" href="/docs.advanced.way/assets/js/10.dde4a0bb.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/100.132f7945.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/101.0d5f4a32.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/102.80ace46c.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/103.4c4c3819.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/104.0c7f1c5d.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/105.1c874d53.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/106.5fae89de.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/107.2b22f17d.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/108.82911517.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/109.0454b34f.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/110.a6389853.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/111.778c7d51.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/112.73dda31c.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/113.b67559ef.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/114.8f91fcdf.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/115.5125d26d.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/116.62c4e2c8.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/117.3604d08b.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/118.20e9d763.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/119.601e8584.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/12.acf39d86.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/120.fd12df08.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/121.d96db46c.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/122.117bbd21.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/123.02bd0ce7.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/124.b7f3ea10.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/125.95e840f6.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/126.2fa2caf8.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/127.5e259d1e.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/128.8165bd78.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/129.898c58b7.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/13.96863fdb.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/130.24a74748.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/131.b88fe009.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/132.af7b5821.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/133.b6d3c072.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/134.bdb67353.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/135.ef02eea5.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/136.9fe990e2.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/137.581d1b32.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/138.e36e11c3.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/139.7b55b179.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/14.f567cca5.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/140.c94307b8.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/141.a510d36e.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/142.b65d7814.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/143.fad6c14b.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/144.c02da052.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/145.1a77f391.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/146.868f4e2e.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/147.274172eb.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/148.b53ddefa.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/149.2cf0dbf8.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/15.7d61a336.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/150.d4e2012a.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/151.2cc118b5.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/152.2bff5859.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/153.2899396b.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/154.8774e60b.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/155.ec7f1a48.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/156.16789bd0.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/157.e3de848e.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/158.f59e234e.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/159.8730d4f0.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/16.dc8ae97f.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/160.4e9dbedd.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/161.1c55fd41.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/162.86579af8.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/163.75b9e9a9.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/164.fb8bba0e.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/165.12b93708.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/166.aec5066b.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/167.118995cd.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/168.a5c7a62d.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/169.3862d202.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/17.4e47c2f8.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/170.946c61f7.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/171.af4e63c8.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/172.39996fa4.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/173.d1e17647.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/174.6fd7c55e.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/175.b55ce494.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/176.82380935.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/177.ada4887f.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/178.21e285b4.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/179.a6344187.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/18.0644cf73.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/180.5ac3cde6.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/181.09fbc1b2.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/182.2192599d.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/183.33c72c92.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/184.f5ddfb07.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/185.ba9af305.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/186.2a4186dc.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/187.3b81c0f0.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/188.326724e3.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/189.8180f3b7.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/19.470e491e.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/190.0264d447.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/191.0db33a4a.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/192.37c6c274.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/193.696d0aa5.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/194.dfa60a76.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/20.c7c22b93.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/21.dda6819f.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/22.0412947b.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/23.87b921e0.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/24.0e61cca0.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/25.10f968db.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/26.fdf9806a.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/27.39960cd2.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/28.f3ba7e15.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/29.f485920d.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/3.c8bcbb1b.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/30.20568904.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/31.ba71b66d.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/32.a54790ad.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/33.0b0725e9.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/34.e4546d04.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/35.d7ce8c05.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/36.a4928ed1.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/37.b3a4a9fd.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/38.9d613fe9.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/39.aa291f04.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/4.0cfc809e.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/40.6fa59393.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/41.47f3e20e.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/42.f05ed32c.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/43.b33ba055.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/44.ba9230fa.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/45.6746a9b5.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/46.9af44ec6.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/47.a2738891.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/48.aa83cb03.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/49.1779467e.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/5.ee5b4f84.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/50.4248476d.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/51.c9c1e2c7.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/52.2d11f307.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/53.6f58ff47.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/54.c56d0e1a.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/55.0f3695cc.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/56.71606f8e.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/57.c26648f2.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/58.e9325518.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/59.e0d9cd3f.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/60.083da66b.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/61.d611974a.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/62.7039d1d2.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/63.c939448e.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/64.23879093.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/65.771ca86b.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/66.5dfe4fb9.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/67.206e84f6.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/68.ce6e25df.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/69.13423ff5.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/7.24ee8494.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/70.c4eb2958.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/71.771e3200.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/72.7447c341.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/73.3f32b61f.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/74.594294c3.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/75.dda53e93.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/76.c775ea70.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/77.f07a7afa.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/78.e8c6bc68.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/79.0dcaaa6c.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/8.fd68908b.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/80.bbe8d216.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/81.3257e7e4.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/82.c2bc79e3.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/83.95ef5d21.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/84.9cab95c8.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/85.48462bc2.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/86.af15e09c.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/87.95d98c12.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/88.10b9cbc0.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/89.93f16a41.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/9.9a36e423.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/90.29bcd676.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/91.0edbd2d3.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/92.95f52ecf.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/93.1b30007c.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/94.7afc9382.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/95.77037942.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/96.ca441b02.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/97.51a29095.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/98.92862522.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/99.c93daf02.js">
    <link rel="stylesheet" href="/docs.advanced.way/assets/css/0.styles.b15a9a47.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/docs.advanced.way/" class="home-link router-link-active"><!----> <span class="site-name">è¿›é˜¶ä¹‹è·¯</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/docs.advanced.way/java/" class="nav-link router-link-active">
  Java
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="å¸¸ç”¨æ¡†æ¶" class="dropdown-title"><span class="title">å¸¸ç”¨æ¡†æ¶</span> <span class="arrow down"></span></button> <button type="button" aria-label="å¸¸ç”¨æ¡†æ¶" class="mobile-dropdown-title"><span class="title">å¸¸ç”¨æ¡†æ¶</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs.advanced.way/framework/spring/" class="nav-link">
  Spring
</a></li><li class="dropdown-item"><!----> <a href="/docs.advanced.way/framework/mybatis/" class="nav-link">
  Mybatis
</a></li><li class="dropdown-item"><!----> <a href="/docs.advanced.way/framework/auth/" class="nav-link">
  æƒé™ç®¡ç†
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ä¸­é—´ä»¶" class="dropdown-title"><span class="title">ä¸­é—´ä»¶</span> <span class="arrow down"></span></button> <button type="button" aria-label="ä¸­é—´ä»¶" class="mobile-dropdown-title"><span class="title">ä¸­é—´ä»¶</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs.advanced.way/middleware/distributed/" class="nav-link">
  åˆ†å¸ƒå¼
</a></li><li class="dropdown-item"><!----> <a href="/docs.advanced.way/middleware/tranctional/" class="nav-link">
  äº‹åŠ¡
</a></li><li class="dropdown-item"><!----> <a href="/docs.advanced.way/middleware/servicemesh/" class="nav-link">
  æœåŠ¡ç½‘æ ¼
</a></li><li class="dropdown-item"><!----> <a href="/docs.advanced.way/middleware/mq/" class="nav-link">
  æ¶ˆæ¯é˜Ÿåˆ—
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="äº‘åŸç”Ÿ" class="dropdown-title"><span class="title">äº‘åŸç”Ÿ</span> <span class="arrow down"></span></button> <button type="button" aria-label="äº‘åŸç”Ÿ" class="mobile-dropdown-title"><span class="title">äº‘åŸç”Ÿ</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs.advanced.way/cloud/docker/" class="nav-link">
  Dockerå®¹å™¨
</a></li><li class="dropdown-item"><!----> <a href="/docs.advanced.way/cloud/k8s/" class="nav-link">
  Kubernetes
</a></li><li class="dropdown-item"><!----> <a href="/docs.advanced.way/cloud/serverless/" class="nav-link">
  Serverless
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="æœåŠ¡å™¨" class="dropdown-title"><span class="title">æœåŠ¡å™¨</span> <span class="arrow down"></span></button> <button type="button" aria-label="æœåŠ¡å™¨" class="mobile-dropdown-title"><span class="title">æœåŠ¡å™¨</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs.advanced.way/linux/" class="nav-link">
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/docs.advanced.way/cache/" class="nav-link">
  ç¼“å­˜
</a></li><li class="dropdown-item"><!----> <a href="/docs.advanced.way/db/" class="nav-link">
  æ•°æ®åº“
</a></li><li class="dropdown-item"><!----> <a href="/docs.advanced.way/cs/" class="nav-link">
  è®¡ç®—æœºç³»ç»Ÿ
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ç¼–ç å®è·µ" class="dropdown-title"><span class="title">ç¼–ç å®è·µ</span> <span class="arrow down"></span></button> <button type="button" aria-label="ç¼–ç å®è·µ" class="mobile-dropdown-title"><span class="title">ç¼–ç å®è·µ</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs.advanced.way/algorithm/" class="nav-link">
  ç®—æ³•/æ•°æ®ç»“æ„
</a></li><li class="dropdown-item"><!----> <a href="/docs.advanced.way/patterns/" class="nav-link">
  è®¾è®¡æ¨¡å¼
</a></li><li class="dropdown-item"><!----> <a href="/docs.advanced.way/architecture/" class="nav-link">
  æ¶æ„è®¾è®¡
</a></li><li class="dropdown-item"><!----> <a href="/docs.advanced.way/job/" class="nav-link">
  é¢è¯•
</a></li><li class="dropdown-item"><!----> <a href="/docs.advanced.way/memo/" class="nav-link">
  å¤‡å¿˜
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="å°ç™¾ç§‘" class="dropdown-title"><span class="title">å°ç™¾ç§‘</span> <span class="arrow down"></span></button> <button type="button" aria-label="å°ç™¾ç§‘" class="mobile-dropdown-title"><span class="title">å°ç™¾ç§‘</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs.advanced.way/cyclopedia/classnotes/" class="nav-link">
  è¯¾å ‚ç¬”è®°
</a></li><li class="dropdown-item"><!----> <a href="/docs.advanced.way/cyclopedia/chinese/" class="nav-link">
  å¤§ä¸­å›½ğŸ‡¨ğŸ‡³
</a></li></ul></div></div> <a href="https://github.com/wangwei461/docs.advanced.way.git" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/docs.advanced.way/java/" class="nav-link router-link-active">
  Java
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="å¸¸ç”¨æ¡†æ¶" class="dropdown-title"><span class="title">å¸¸ç”¨æ¡†æ¶</span> <span class="arrow down"></span></button> <button type="button" aria-label="å¸¸ç”¨æ¡†æ¶" class="mobile-dropdown-title"><span class="title">å¸¸ç”¨æ¡†æ¶</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs.advanced.way/framework/spring/" class="nav-link">
  Spring
</a></li><li class="dropdown-item"><!----> <a href="/docs.advanced.way/framework/mybatis/" class="nav-link">
  Mybatis
</a></li><li class="dropdown-item"><!----> <a href="/docs.advanced.way/framework/auth/" class="nav-link">
  æƒé™ç®¡ç†
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ä¸­é—´ä»¶" class="dropdown-title"><span class="title">ä¸­é—´ä»¶</span> <span class="arrow down"></span></button> <button type="button" aria-label="ä¸­é—´ä»¶" class="mobile-dropdown-title"><span class="title">ä¸­é—´ä»¶</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs.advanced.way/middleware/distributed/" class="nav-link">
  åˆ†å¸ƒå¼
</a></li><li class="dropdown-item"><!----> <a href="/docs.advanced.way/middleware/tranctional/" class="nav-link">
  äº‹åŠ¡
</a></li><li class="dropdown-item"><!----> <a href="/docs.advanced.way/middleware/servicemesh/" class="nav-link">
  æœåŠ¡ç½‘æ ¼
</a></li><li class="dropdown-item"><!----> <a href="/docs.advanced.way/middleware/mq/" class="nav-link">
  æ¶ˆæ¯é˜Ÿåˆ—
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="äº‘åŸç”Ÿ" class="dropdown-title"><span class="title">äº‘åŸç”Ÿ</span> <span class="arrow down"></span></button> <button type="button" aria-label="äº‘åŸç”Ÿ" class="mobile-dropdown-title"><span class="title">äº‘åŸç”Ÿ</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs.advanced.way/cloud/docker/" class="nav-link">
  Dockerå®¹å™¨
</a></li><li class="dropdown-item"><!----> <a href="/docs.advanced.way/cloud/k8s/" class="nav-link">
  Kubernetes
</a></li><li class="dropdown-item"><!----> <a href="/docs.advanced.way/cloud/serverless/" class="nav-link">
  Serverless
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="æœåŠ¡å™¨" class="dropdown-title"><span class="title">æœåŠ¡å™¨</span> <span class="arrow down"></span></button> <button type="button" aria-label="æœåŠ¡å™¨" class="mobile-dropdown-title"><span class="title">æœåŠ¡å™¨</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs.advanced.way/linux/" class="nav-link">
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/docs.advanced.way/cache/" class="nav-link">
  ç¼“å­˜
</a></li><li class="dropdown-item"><!----> <a href="/docs.advanced.way/db/" class="nav-link">
  æ•°æ®åº“
</a></li><li class="dropdown-item"><!----> <a href="/docs.advanced.way/cs/" class="nav-link">
  è®¡ç®—æœºç³»ç»Ÿ
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ç¼–ç å®è·µ" class="dropdown-title"><span class="title">ç¼–ç å®è·µ</span> <span class="arrow down"></span></button> <button type="button" aria-label="ç¼–ç å®è·µ" class="mobile-dropdown-title"><span class="title">ç¼–ç å®è·µ</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs.advanced.way/algorithm/" class="nav-link">
  ç®—æ³•/æ•°æ®ç»“æ„
</a></li><li class="dropdown-item"><!----> <a href="/docs.advanced.way/patterns/" class="nav-link">
  è®¾è®¡æ¨¡å¼
</a></li><li class="dropdown-item"><!----> <a href="/docs.advanced.way/architecture/" class="nav-link">
  æ¶æ„è®¾è®¡
</a></li><li class="dropdown-item"><!----> <a href="/docs.advanced.way/job/" class="nav-link">
  é¢è¯•
</a></li><li class="dropdown-item"><!----> <a href="/docs.advanced.way/memo/" class="nav-link">
  å¤‡å¿˜
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="å°ç™¾ç§‘" class="dropdown-title"><span class="title">å°ç™¾ç§‘</span> <span class="arrow down"></span></button> <button type="button" aria-label="å°ç™¾ç§‘" class="mobile-dropdown-title"><span class="title">å°ç™¾ç§‘</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs.advanced.way/cyclopedia/classnotes/" class="nav-link">
  è¯¾å ‚ç¬”è®°
</a></li><li class="dropdown-item"><!----> <a href="/docs.advanced.way/cyclopedia/chinese/" class="nav-link">
  å¤§ä¸­å›½ğŸ‡¨ğŸ‡³
</a></li></ul></div></div> <a href="https://github.com/wangwei461/docs.advanced.way.git" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>åŸºç¡€å†…å®¹</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>é›†åˆ</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>é«˜å¹¶å‘</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs.advanced.way/java/hc/é«˜å¹¶å‘.html" class="sidebar-link">é«˜å¹¶å‘</a></li><li><a href="/docs.advanced.way/java/hc/å¤šçº¿ç¨‹.html" class="active sidebar-link">å¤šçº¿ç¨‹</a></li><li><a href="/docs.advanced.way/java/hc/å¹¶å‘ç¼–ç¨‹çš„è‰ºæœ¯.html" class="sidebar-link">å¹¶å‘ç¼–ç¨‹çš„è‰ºæœ¯</a></li><li><a href="/docs.advanced.way/java/hc/å†…å­˜æ¨¡å‹.html" class="sidebar-link">å†…å­˜æ¨¡å‹</a></li><li><a href="/docs.advanced.way/java/hc/åŸå­ç±».html" class="sidebar-link">åŸå­ç±»</a></li><li><a href="/docs.advanced.way/java/hc/å¹¶å‘å®¹å™¨.html" class="sidebar-link">å¹¶å‘å®¹å™¨</a></li><li><a href="/docs.advanced.way/java/hc/å¹¶å‘å·¥å…·ç±».html" class="sidebar-link">å¹¶å‘å·¥å…·ç±»</a></li><li><a href="/docs.advanced.way/java/hc/çº¿ç¨‹æ± .html" class="sidebar-link">çº¿ç¨‹æ± </a></li><li><a href="/docs.advanced.way/java/hc/é”.html" class="sidebar-link">é”</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JVM</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="çº¿ç¨‹"><a href="#çº¿ç¨‹" class="header-anchor">#</a> çº¿ç¨‹</h2> <p>ç°ä»£æ“ä½œç³»ç»Ÿåœ¨è¿è¡Œä¸€ä¸ªç¨‹åºæ—¶ï¼Œä¼šåˆ›å»ºä¸€ä¸ªè¿›ç¨‹ã€‚æ“ä½œç³»ç»Ÿè°ƒåº¦æœ€å°çš„å•å…ƒæ˜¯çº¿ç¨‹ã€‚
ä¸€ä¸ªè¿›ç¨‹å†…å¯ä»¥åˆ›å»ºå¤šä¸ªçº¿ç¨‹ï¼Œè¿™äº›çº¿ç¨‹åˆæœ‰å„è‡ªçš„è®¡æ•°å™¨ï¼Œå †æ ˆå’Œå±€éƒ¨å˜é‡</p> <p>ä¼˜ç‚¹:</p> <ul><li>æ›´å¤šçš„å¤„ç†å™¨æ ¸å¿ƒ</li> <li>æ›´å¿«çš„å“åº”æ—¶é—´</li> <li>æ›´å¥½çš„ç¼–ç¨‹æ¨¡å‹</li></ul> <h3 id="å¹¶å‘å’Œå¹¶è¡Œ"><a href="#å¹¶å‘å’Œå¹¶è¡Œ" class="header-anchor">#</a> å¹¶å‘å’Œå¹¶è¡Œ</h3> <p>å¤šçº¿ç¨‹æ˜¯å¤šä»»åŠ¡çš„ä¸€ç§ç‰¹åˆ«çš„å½¢å¼ï¼Œä½†å¤šçº¿ç¨‹ä½¿ç”¨äº†æ›´å°çš„èµ„æºå¼€é”€</p> <ul><li>å¹¶è¡Œæ˜¯æŒ‡åŒä¸€æ—¶åˆ»ï¼Œå¤šä¸ªå‘½ä»¤åœ¨å¤šä¸ªå¤„ç†å™¨ä¸ŠåŒæ—¶æ‰§è¡Œï¼›</li> <li>å¹¶å‘æ˜¯æŒ‡åœ¨åŒä¸€æ—¶åˆ»ï¼Œåªæœ‰ä¸€æ¡å‘½ä»¤æ˜¯åœ¨å¤„ç†å™¨ä¸Šæ‰§è¡Œçš„ï¼Œä½†å¤šä¸ªè¿›ç¨‹å‘½ä»¤è¢«å¿«é€Ÿè½®æ¢æ‰§è¡Œï¼Œä½¿å¾—åœ¨å®è§‚ä¸Šå…·æœ‰å¤šä¸ªè¿›ç¨‹åŒæ—¶æ‰§è¡Œçš„æ•ˆæœ</li></ul> <h3 id="çº¿ç¨‹çŠ¶æ€"><a href="#çº¿ç¨‹çŠ¶æ€" class="header-anchor">#</a> çº¿ç¨‹çŠ¶æ€</h3> <p><img src="/docs.advanced.way/assets/img/1689841-af3e5b75b44e972c.95962134.png" alt=""></p> <p><img src="/docs.advanced.way/assets/img/1689841-383f7101e6588094.7bc80291.png" alt=""></p> <ol><li>æ–°å»ºçŠ¶æ€:<br>
ä½¿ç”¨ new å…³é”®å­—å’Œ Thread ç±»æˆ–å…¶å­ç±»å»ºç«‹ä¸€ä¸ªçº¿ç¨‹å¯¹è±¡åï¼Œè¯¥çº¿ç¨‹å¯¹è±¡å°±å¤„äºæ–°å»ºçŠ¶æ€ã€‚å®ƒä¿æŒè¿™ä¸ªçŠ¶æ€ç›´åˆ°ç¨‹åº start() è¿™ä¸ªçº¿ç¨‹ã€‚</li> <li>å°±ç»ªçŠ¶æ€:<br>
å½“çº¿ç¨‹å¯¹è±¡è°ƒç”¨äº†start()æ–¹æ³•ä¹‹åï¼Œè¯¥çº¿ç¨‹å°±è¿›å…¥å°±ç»ªçŠ¶æ€ã€‚å°±ç»ªçŠ¶æ€çš„çº¿ç¨‹å¤„äºå°±ç»ªé˜Ÿåˆ—ä¸­ï¼Œè¦ç­‰å¾…JVMé‡Œçº¿ç¨‹è°ƒåº¦å™¨çš„è°ƒåº¦ã€‚</li></ol> <blockquote><p>æ¯ä¸ªé”å¯¹è±¡éƒ½æœ‰ä¸¤ä¸ªé˜Ÿåˆ—ï¼Œä¸€ä¸ªæ˜¯å°±ç»ªé˜Ÿåˆ—ï¼Œä¸€ä¸ªæ˜¯é˜»å¡é˜Ÿåˆ—ï¼Œå°±ç»ªé˜Ÿåˆ—å­˜å‚¨äº†å°†è¦è·å¾—é”çš„çº¿ç¨‹ï¼Œé˜»å¡é˜Ÿåˆ—å­˜å‚¨äº†è¢«é˜»å¡çš„çº¿ç¨‹ï¼Œå½“ä¸€ä¸ªè¢«çº¿ç¨‹è¢«å”¤é†’ (notify)åï¼Œæ‰ä¼šè¿›å…¥åˆ°å°±ç»ªé˜Ÿåˆ—ï¼Œç­‰å¾…è·å¾—é”</p></blockquote> <ol start="3"><li>è¿è¡ŒçŠ¶æ€:<br>
å¦‚æœå°±ç»ªçŠ¶æ€çš„çº¿ç¨‹è·å– CPU èµ„æºï¼Œå°±å¯ä»¥æ‰§è¡Œ run()ï¼Œæ­¤æ—¶çº¿ç¨‹ä¾¿å¤„äºè¿è¡ŒçŠ¶æ€ã€‚å¤„äºè¿è¡ŒçŠ¶æ€çš„çº¿ç¨‹æœ€ä¸ºå¤æ‚ï¼Œå®ƒå¯ä»¥å˜ä¸ºé˜»å¡çŠ¶æ€ã€å°±ç»ªçŠ¶æ€å’Œæ­»äº¡çŠ¶æ€ã€‚</li> <li>é˜»å¡çŠ¶æ€:<br>
å¦‚æœä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œäº†sleepï¼ˆç¡çœ ï¼‰ã€suspendï¼ˆæŒ‚èµ·ï¼‰ç­‰æ–¹æ³•ï¼Œå¤±å»æ‰€å ç”¨èµ„æºä¹‹åï¼Œè¯¥çº¿ç¨‹å°±ä»è¿è¡ŒçŠ¶æ€è¿›å…¥é˜»å¡çŠ¶æ€ã€‚åœ¨ç¡çœ æ—¶é—´å·²åˆ°æˆ–è·å¾—è®¾å¤‡èµ„æºåå¯ä»¥é‡æ–°è¿›å…¥å°±ç»ªçŠ¶æ€ã€‚<br>
å¯ä»¥åˆ†ä¸ºä¸‰ç§ï¼š
ç­‰å¾…é˜»å¡ï¼šè¿è¡ŒçŠ¶æ€ä¸­çš„çº¿ç¨‹æ‰§è¡Œ wait() æ–¹æ³•ï¼Œä½¿çº¿ç¨‹è¿›å…¥åˆ°ç­‰å¾…é˜»å¡çŠ¶æ€ã€‚<br>
åŒæ­¥é˜»å¡ï¼šçº¿ç¨‹åœ¨è·å– synchronized åŒæ­¥é”å¤±è´¥(å› ä¸ºåŒæ­¥é”è¢«å…¶ä»–çº¿ç¨‹å ç”¨)ã€‚<br>
å…¶ä»–é˜»å¡ï¼šé€šè¿‡è°ƒç”¨çº¿ç¨‹çš„ sleep() æˆ– join() å‘å‡ºäº† I/O è¯·æ±‚æ—¶ï¼Œçº¿ç¨‹å°±ä¼šè¿›å…¥åˆ°é˜»å¡çŠ¶æ€ã€‚å½“sleep() çŠ¶æ€è¶…æ—¶ï¼Œjoin() ç­‰å¾…çº¿ç¨‹ç»ˆæ­¢æˆ–è¶…æ—¶ï¼Œæˆ–è€… I/O å¤„ç†å®Œæ¯•ï¼Œçº¿ç¨‹é‡æ–°è½¬å…¥å°±ç»ªçŠ¶æ€ã€‚</li></ol> <ul><li>è°ƒç”¨join()å’Œsleep()æ–¹æ³•ï¼Œsleep()æ—¶é—´ç»“æŸæˆ–è¢«æ‰“æ–­ï¼Œjoin()ä¸­æ–­,IOå®Œæˆéƒ½ä¼šå›åˆ°RunnableçŠ¶æ€ï¼Œç­‰å¾…JVMçš„è°ƒåº¦ã€‚</li> <li>è°ƒç”¨wait()ï¼Œä½¿è¯¥çº¿ç¨‹å¤„äºç­‰å¾…æ± (wait blocked pool),ç›´åˆ°notify()/notifyAll()ï¼Œçº¿ç¨‹è¢«å”¤é†’è¢«æ”¾åˆ°é”å®šæ± (lock blocked pool )ï¼Œé‡Šæ”¾åŒæ­¥é”ä½¿çº¿ç¨‹å›åˆ°å¯è¿è¡ŒçŠ¶æ€ï¼ˆRunnableï¼‰</li> <li>å¯¹RunningçŠ¶æ€çš„çº¿ç¨‹åŠ åŒæ­¥é”(Synchronized)ä½¿å…¶è¿›å…¥(lock blocked pool ),åŒæ­¥é”è¢«é‡Šæ”¾è¿›å…¥å¯è¿è¡ŒçŠ¶æ€(Runnable)ã€‚</li></ul> <ol start="5"><li>æ­»äº¡çŠ¶æ€:
ä¸€ä¸ªè¿è¡ŒçŠ¶æ€çš„çº¿ç¨‹å®Œæˆä»»åŠ¡æˆ–è€…å…¶ä»–ç»ˆæ­¢æ¡ä»¶å‘ç”Ÿæ—¶ï¼Œè¯¥çº¿ç¨‹å°±åˆ‡æ¢åˆ°ç»ˆæ­¢çŠ¶æ€ã€‚</li></ol> <blockquote><p>start()çš„å«ä¹‰: å½“å‰çº¿ç¨‹åŒæ­¥å‘ŠçŸ¥è™šæ‹Ÿæœºï¼Œåªè¦çº¿ç¨‹è§„åˆ’å™¨ç©ºé—²ï¼Œåº”ç«‹å³å¯åŠ¨è°ƒç”¨start()æ–¹æ³•çš„çº¿ç¨‹
join()çš„å«ä¹‰: å½“å‰çº¿ç¨‹ç­‰å¾…threadçº¿ç¨‹ç»ˆæ­¢ä¹‹åæ‰ä»thread.join()è¿”å›</p></blockquote> <h3 id="åˆ›å»ºçº¿ç¨‹"><a href="#åˆ›å»ºçº¿ç¨‹" class="header-anchor">#</a> åˆ›å»ºçº¿ç¨‹</h3> <h4 id="åˆ›å»º"><a href="#åˆ›å»º" class="header-anchor">#</a> åˆ›å»º</h4> <ol><li>ç»§æ‰¿Threadç±»</li></ol> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">class</span> <span class="token class-name">Thread1</span> <span class="token keyword">extends</span> <span class="token class-name">Thread</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">// to do</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="2"><li>å®ç° Runnable</li></ol> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">class</span> class2 <span class="token keyword">implements</span> <span class="token class-name">Runnable</span><span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="3"><li>å®ç° Callable</li></ol> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">class</span> class3 <span class="token keyword">implements</span> <span class="token class-name">Callable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="åŸç†"><a href="#åŸç†" class="header-anchor">#</a> åŸç†</h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// æ¥å—æ³›å‹å‚æ•°</span>
<span class="token annotation punctuation">@FunctionalInterface</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Callable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token class-name">V</span> <span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@FunctionalInterface</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Runnable</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// å®ç° Runnable</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Thread</span> <span class="token keyword">implements</span> <span class="token class-name">Runnable</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Runnableæ²¡æœ‰è¿”å›å€¼ï¼›Callableå¯ä»¥è¿”å›æ‰§è¡Œç»“æœï¼Œæ˜¯ä¸ªæ³›å‹ï¼Œå’ŒFutureã€FutureTaské…åˆå¯ä»¥ç”¨æ¥è·å–å¼‚æ­¥æ‰§è¡Œçš„ç»“æœ</p> <h5 id="future"><a href="#future" class="header-anchor">#</a> Future</h5> <p>Futureå°±æ˜¯å¯¹äºå…·ä½“çš„Runnableæˆ–è€…Callableä»»åŠ¡çš„æ‰§è¡Œç»“æœè¿›è¡Œå–æ¶ˆã€æŸ¥è¯¢æ˜¯å¦å®Œæˆã€è·å–ç»“æœã€‚
å¿…è¦æ—¶å¯ä»¥é€šè¿‡getæ–¹æ³•è·å–æ‰§è¡Œç»“æœï¼Œè¯¥æ–¹æ³•ä¼šé˜»å¡ç›´åˆ°ä»»åŠ¡è¿”å›ç»“æœ</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Future</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
	<span class="token comment">// ç”¨æ¥å–æ¶ˆä»»åŠ¡ï¼Œå¦‚æœå–æ¶ˆä»»åŠ¡æˆåŠŸåˆ™è¿”å›trueï¼Œå¦‚æœå–æ¶ˆä»»åŠ¡å¤±è´¥åˆ™è¿”å›false</span>
	<span class="token keyword">boolean</span> <span class="token function">cancel</span><span class="token punctuation">(</span><span class="token keyword">boolean</span> mayInterruptIfRunning<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// åˆ¤æ–­ä»»åŠ¡æ˜¯å¦è¢«å–æ¶ˆæˆåŠŸ</span>
	<span class="token keyword">boolean</span> <span class="token function">isCancelled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// åˆ¤æ–­ä»»åŠ¡æ˜¯å¦å·²ç»å®Œæˆ</span>
	<span class="token keyword">boolean</span> <span class="token function">isDone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// ç”¨æ¥è·å–æ‰§è¡Œç»“æœï¼Œè¿™ä¸ªæ–¹æ³•ä¼šäº§ç”Ÿé˜»å¡ï¼Œä¼šä¸€ç›´ç­‰åˆ°ä»»åŠ¡æ‰§è¡Œå®Œæ¯•æ‰è¿”å›</span>
	<span class="token class-name">V</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span><span class="token punctuation">,</span> <span class="token class-name">ExecutionException</span><span class="token punctuation">;</span>
	<span class="token comment">// ç”¨æ¥è·å–æ‰§è¡Œç»“æœï¼Œå¦‚æœåœ¨æŒ‡å®šæ—¶é—´å†…ï¼Œè¿˜æ²¡è·å–åˆ°ç»“æœï¼Œå°±ç›´æ¥è¿”å›null</span>
	<span class="token class-name">V</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token keyword">long</span> timeout<span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span> unit<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">InterruptedException</span><span class="token punctuation">,</span> <span class="token class-name">ExecutionException</span><span class="token punctuation">,</span> <span class="token class-name">TimeoutException</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h5 id="runnablefuture-class"><a href="#runnablefuture-class" class="header-anchor">#</a> RunnableFuture.class</h5> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">RunnableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">extends</span> <span class="token class-name">Runnable</span><span class="token punctuation">,</span> <span class="token class-name">Future</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h5 id="futuretask-class"><a href="#futuretask-class" class="header-anchor">#</a> FutureTask.class</h5> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FutureTask</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">implements</span> <span class="token class-name">RunnableFuture</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
	<span class="token keyword">private</span> <span class="token keyword">volatile</span> <span class="token keyword">int</span> state<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> NEW          <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> COMPLETING   <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> NORMAL       <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> EXCEPTIONAL  <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> CANCELLED    <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> INTERRUPTING <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> INTERRUPTED  <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span>

    <span class="token comment">/** The underlying callable; nulled out after running */</span>
    <span class="token keyword">private</span> <span class="token class-name">Callable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> callable<span class="token punctuation">;</span>
    <span class="token comment">/** The result to return or exception to throw from get() */</span>
    <span class="token keyword">private</span> <span class="token class-name">Object</span> outcome<span class="token punctuation">;</span> <span class="token comment">// non-volatile, protected by state reads/writes</span>
    <span class="token comment">/** The thread running the callable; CASed during run() */</span>
    <span class="token keyword">private</span> <span class="token keyword">volatile</span> <span class="token class-name">Thread</span> runner<span class="token punctuation">;</span>
    <span class="token comment">/** Treiber stack of waiting threads */</span>
    <span class="token keyword">private</span> <span class="token keyword">volatile</span> <span class="token class-name">WaitNode</span> waiters<span class="token punctuation">;</span>

	<span class="token keyword">public</span> <span class="token class-name">FutureTask</span><span class="token punctuation">(</span><span class="token class-name">Callable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> callable<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>callable <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">NullPointerException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>callable <span class="token operator">=</span> callable<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> NEW<span class="token punctuation">;</span>       <span class="token comment">// ensure visibility of callable</span>
    <span class="token punctuation">}</span>

	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>state <span class="token operator">!=</span> NEW <span class="token operator">||</span>
            <span class="token operator">!</span>RUNNER<span class="token punctuation">.</span><span class="token function">compareAndSet</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">Callable</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">V</span><span class="token punctuation">&gt;</span></span> c <span class="token operator">=</span> callable<span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>c <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> state <span class="token operator">==</span> NEW<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">V</span> result<span class="token punctuation">;</span>
                <span class="token keyword">boolean</span> ran<span class="token punctuation">;</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
					<span class="token comment">// æ‰§è¡Œä»»åŠ¡</span>
                    result <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    ran <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    result <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
                    ran <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
                    <span class="token function">setException</span><span class="token punctuation">(</span>ex<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>ran<span class="token punctuation">)</span>
					<span class="token comment">// è®¾ç½®å€¼</span>
                    <span class="token function">set</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
            <span class="token comment">// runner must be non-null until state is settled to</span>
            <span class="token comment">// prevent concurrent calls to run()</span>
            runner <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
            <span class="token comment">// state must be re-read after nulling runner to prevent</span>
            <span class="token comment">// leaked interrupts</span>
            <span class="token keyword">int</span> s <span class="token operator">=</span> state<span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>s <span class="token operator">&gt;=</span> INTERRUPTING<span class="token punctuation">)</span>
                <span class="token function">handlePossibleCancellationInterrupt</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

	<span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">set</span><span class="token punctuation">(</span><span class="token class-name">V</span> v<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>STATE<span class="token punctuation">.</span><span class="token function">compareAndSet</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> NEW<span class="token punctuation">,</span> COMPLETING<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            outcome <span class="token operator">=</span> v<span class="token punctuation">;</span>
            STATE<span class="token punctuation">.</span><span class="token function">setRelease</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> NORMAL<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// final state</span>
            <span class="token function">finishCompletion</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

	<span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">finishCompletion</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// assert state &gt; COMPLETING;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">WaitNode</span> q<span class="token punctuation">;</span> <span class="token punctuation">(</span>q <span class="token operator">=</span> waiters<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>WAITERS<span class="token punctuation">.</span><span class="token function">weakCompareAndSet</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> q<span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">;</span><span class="token punctuation">;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token class-name">Thread</span> t <span class="token operator">=</span> q<span class="token punctuation">.</span>thread<span class="token punctuation">;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>t <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        q<span class="token punctuation">.</span>thread <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
                        <span class="token class-name">LockSupport</span><span class="token punctuation">.</span><span class="token function">unpark</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    <span class="token class-name">WaitNode</span> next <span class="token operator">=</span> q<span class="token punctuation">.</span>next<span class="token punctuation">;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>next <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
                        <span class="token keyword">break</span><span class="token punctuation">;</span>
                    q<span class="token punctuation">.</span>next <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span> <span class="token comment">// unlink to help gc</span>
                    q <span class="token operator">=</span> next<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">break</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token function">done</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        callable <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>        <span class="token comment">// to reduce footprint</span>
    <span class="token punctuation">}</span>

	<span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">done</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="çº¿ç¨‹ç®¡ç†"><a href="#çº¿ç¨‹ç®¡ç†" class="header-anchor">#</a> çº¿ç¨‹ç®¡ç†</h3> <h4 id="ç¡çœ "><a href="#ç¡çœ " class="header-anchor">#</a> ç¡çœ </h4> <p>è®©å½“å‰æ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹æš‚åœä¸€æ®µæ—¶é—´ï¼Œå¹¶è¿›å…¥é˜»å¡çŠ¶æ€ï¼Œåˆ™å¯ä»¥é€šè¿‡è°ƒç”¨Threadçš„sleepæ–¹æ³•</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token operator">*</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ä¼‘çœ 1ç§’</span>
</code></pre></div><h4 id="çº¿ç¨‹è®©æ­¥-yield"><a href="#çº¿ç¨‹è®©æ­¥-yield" class="header-anchor">#</a> çº¿ç¨‹è®©æ­¥â€”â€”yield</h4> <p>yield()æ–¹æ³•åªæ˜¯è®©å½“å‰çº¿ç¨‹æš‚åœä¸€ä¸‹ï¼Œé‡æ–°è¿›å…¥å°±ç»ªçš„çº¿ç¨‹æ± ä¸­ï¼Œè®©ç³»ç»Ÿçš„çº¿ç¨‹è°ƒåº¦å™¨é‡æ–°è°ƒåº¦å™¨é‡æ–°è°ƒåº¦ä¸€æ¬¡ï¼ˆä¸è¿›å…¥é˜»å¡çŠ¶æ€ï¼‰</p> <h4 id="çº¿ç¨‹åˆå¹¶"><a href="#çº¿ç¨‹åˆå¹¶" class="header-anchor">#</a> çº¿ç¨‹åˆå¹¶</h4> <p>çº¿ç¨‹çš„åˆå¹¶çš„å«ä¹‰å°±æ˜¯å°†å‡ ä¸ªå¹¶è¡Œçº¿ç¨‹çš„çº¿ç¨‹åˆå¹¶ä¸ºä¸€ä¸ªå•çº¿ç¨‹æ‰§è¡Œï¼Œåº”ç”¨åœºæ™¯æ˜¯å½“ä¸€ä¸ªçº¿ç¨‹å¿…é¡»ç­‰å¾…å¦ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œå®Œæ¯•æ‰èƒ½æ‰§è¡Œæ—¶ï¼ŒThreadç±»æä¾›äº†joinæ–¹æ³•æ¥å®Œæˆè¿™ä¸ªåŠŸèƒ½ï¼Œæ³¨æ„ï¼Œå®ƒä¸æ˜¯é™æ€æ–¹æ³•</p> <h4 id="çº¿ç¨‹çš„ä¼˜å…ˆçº§"><a href="#çº¿ç¨‹çš„ä¼˜å…ˆçº§" class="header-anchor">#</a> çº¿ç¨‹çš„ä¼˜å…ˆçº§</h4> <p>æ¯ä¸€ä¸ª Java çº¿ç¨‹éƒ½æœ‰ä¸€ä¸ªä¼˜å…ˆçº§ï¼Œè¿™æ ·æœ‰åŠ©äºæ“ä½œç³»ç»Ÿç¡®å®šçº¿ç¨‹çš„è°ƒåº¦é¡ºåºã€‚<br>
Java çº¿ç¨‹çš„ä¼˜å…ˆçº§æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œå…¶å–å€¼èŒƒå›´æ˜¯ 1 ï¼ˆThread.MIN_PRIORITY ï¼‰ - 10 ï¼ˆThread.MAX_PRIORITY ï¼‰ã€‚<br>
é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¯ä¸€ä¸ªçº¿ç¨‹éƒ½ä¼šåˆ†é…ä¸€ä¸ªä¼˜å…ˆçº§ NORM_PRIORITYï¼ˆ5ï¼‰ã€‚</p> <h3 id="çº¿ç¨‹è°ƒåº¦"><a href="#çº¿ç¨‹è°ƒåº¦" class="header-anchor">#</a> çº¿ç¨‹è°ƒåº¦</h3> <p>çº¿ç¨‹è°ƒåº¦æ˜¯æŒ‡ç³»ç»Ÿä¸ºçº¿ç¨‹åˆ†é…å¤„ç†å™¨ä½¿ç”¨æƒçš„è¿‡ç¨‹ï¼Œä¸»è¦è°ƒåº¦æ–¹å¼åˆ†ä¸¤ç§ï¼Œåˆ†åˆ«æ˜¯ååŒå¼çº¿ç¨‹è°ƒåº¦å’ŒæŠ¢å å¼çº¿ç¨‹è°ƒåº¦ã€‚</p> <ul><li>ååŒå¼çº¿ç¨‹è°ƒåº¦<br>
çº¿ç¨‹æ‰§è¡Œæ—¶é—´ç”±çº¿ç¨‹æœ¬èº«æ¥æ§åˆ¶ï¼Œçº¿ç¨‹æŠŠè‡ªå·±çš„å·¥ä½œæ‰§è¡Œå®Œä¹‹åï¼Œè¦ä¸»åŠ¨é€šçŸ¥ç³»ç»Ÿåˆ‡æ¢åˆ°å¦å¤–ä¸€ä¸ªçº¿ç¨‹ä¸Šã€‚æœ€å¤§å¥½å¤„æ˜¯å®ç°ç®€å•ï¼Œä¸”åˆ‡æ¢æ“ä½œå¯¹çº¿ç¨‹è‡ªå·±æ˜¯å¯çŸ¥çš„ï¼Œæ²¡å•¥çº¿ç¨‹åŒæ­¥é—®é¢˜ã€‚åå¤„æ˜¯çº¿ç¨‹æ‰§è¡Œæ—¶é—´ä¸å¯æ§åˆ¶ï¼Œå¦‚æœä¸€ä¸ªçº¿ç¨‹æœ‰é—®é¢˜ï¼Œå¯èƒ½ä¸€ç›´é˜»å¡åœ¨é‚£é‡Œã€‚</li> <li>æŠ¢å å¼è°ƒåº¦<br>
æ¯ä¸ªçº¿ç¨‹å°†ç”±ç³»ç»Ÿæ¥åˆ†é…æ‰§è¡Œæ—¶é—´ï¼Œçº¿ç¨‹çš„åˆ‡æ¢ä¸ç”±çº¿ç¨‹æœ¬èº«æ¥å†³å®šï¼ˆJavaä¸­ï¼ŒThread.yield()å¯ä»¥è®©å‡ºæ‰§è¡Œæ—¶é—´ï¼Œä½†æ— æ³•è·å–æ‰§è¡Œæ—¶é—´ï¼‰ã€‚çº¿ç¨‹æ‰§è¡Œæ—¶é—´ç³»ç»Ÿå¯æ§ï¼Œä¹Ÿä¸ä¼šæœ‰ä¸€ä¸ªçº¿ç¨‹å¯¼è‡´æ•´ä¸ªè¿›ç¨‹é˜»å¡ã€‚</li></ul> <blockquote><p>Javaçº¿ç¨‹è°ƒåº¦å°±æ˜¯æŠ¢å å¼è°ƒåº¦ã€‚</p></blockquote> <h3 id="çº¿ç¨‹åŒæ­¥"><a href="#çº¿ç¨‹åŒæ­¥" class="header-anchor">#</a> çº¿ç¨‹åŒæ­¥</h3> <p>javaå…è®¸å¤šçº¿ç¨‹å¹¶å‘æ§åˆ¶ï¼Œå½“å¤šä¸ªçº¿ç¨‹åŒæ—¶æ“ä½œä¸€ä¸ªå¯å…±äº«çš„èµ„æºå˜é‡æ—¶ï¼ˆå¦‚æ•°æ®çš„å¢åˆ æ”¹æŸ¥ï¼‰ï¼Œå°†ä¼šå¯¼è‡´æ•°æ®ä¸å‡†ç¡®ï¼Œç›¸äº’ä¹‹é—´äº§ç”Ÿå†²çªï¼Œå› æ­¤åŠ å…¥åŒæ­¥é”ä»¥é¿å…åœ¨è¯¥çº¿ç¨‹æ²¡æœ‰å®Œæˆæ“ä½œä¹‹å‰ï¼Œè¢«å…¶ä»–çº¿ç¨‹çš„è°ƒç”¨ï¼Œä»è€Œä¿è¯äº†è¯¥å˜é‡çš„å”¯ä¸€æ€§å’Œå‡†ç¡®æ€§ã€‚</p> <h4 id="åŒæ­¥æ–¹æ³•"><a href="#åŒæ­¥æ–¹æ³•" class="header-anchor">#</a> åŒæ­¥æ–¹æ³•</h4> <blockquote><p>ç”±äºjavaçš„æ¯ä¸ªå¯¹è±¡éƒ½æœ‰ä¸€ä¸ªå†…ç½®é”ï¼Œå½“ç”¨æ­¤å…³é”®å­—ä¿®é¥°æ–¹æ³•æ—¶ï¼Œå†…ç½®é”ä¼šä¿æŠ¤æ•´ä¸ªæ–¹æ³•ã€‚åœ¨è°ƒç”¨è¯¥æ–¹æ³•å‰ï¼Œéœ€è¦è·å¾—å†…ç½®é”ï¼Œå¦åˆ™å°±å¤„äºé˜»å¡çŠ¶æ€</p></blockquote> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// å¯¹è±¡é”</span>
<span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token keyword">void</span> <span class="token function">fun</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">// todo</span>
<span class="token punctuation">}</span>

<span class="token comment">// ç±»é”</span>
<span class="token keyword">public</span> <span class="token keyword">synchronized</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">fun</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">// todo</span>
<span class="token punctuation">}</span>
</code></pre></div><ol><li><p>å†…ç½®é”ï¼ˆåˆå« éšå¼é”ï¼‰ï¼šsynchronized æ˜¯å†…ç½®äºJDKä¸­çš„ï¼Œåº•å±‚å®ç°æ˜¯nativeï¼›åŒæ—¶ï¼ŒåŠ é”ã€è§£é”éƒ½æ˜¯JDKè‡ªåŠ¨å®Œæˆï¼Œä¸éœ€è¦ç”¨æˆ·æ˜¾å¼åœ°æ§åˆ¶ï¼Œéå¸¸æ–¹ä¾¿ã€‚</p></li> <li><p>åŒæ­¥é”ï¼šsynchronized ç”¨äºåŒæ­¥çº¿ç¨‹ï¼Œä½¿çº¿ç¨‹äº’æ–¥åœ°è®¿é—®æŸæ®µä»£ç å—ã€æ–¹æ³•ã€‚è¿™å°±æ˜¯æ„å‘³ç€æœ€å¤šåªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½å¤Ÿè·å¾—è¯¥é”ï¼Œå½“çº¿ç¨‹Aå°è¯•å»è·å¾—çº¿ç¨‹BæŒæœ‰çš„å†…ç½®é”æ—¶ï¼Œçº¿ç¨‹Aå¿…é¡»ç­‰å¾…æˆ–è€…é˜»å¡ï¼ŒçŸ¥é“çº¿ç¨‹Bé‡Šæ”¾è¿™ä¸ªé”ï¼Œå¦‚æœBçº¿ç¨‹ä¸é‡Šæ”¾è¿™ä¸ªé”ï¼Œé‚£ä¹ˆAçº¿ç¨‹å°†æ°¸è¿œç­‰å¾…ä¸‹å»</p></li> <li><p>å¯¹è±¡é”ï¼šå‡†ç¡®æ¥è¯´ï¼Œæ˜¯åˆ†ä¸ºå¯¹è±¡é”ã€ç±»é”ã€‚synchronized ä»¥å½“å‰çš„æŸä¸ªå¯¹è±¡ä¸ºé”ï¼Œçº¿ç¨‹å¿…é¡»é€šè¿‡äº’æ–¥ç«äº‰æ‹¿åˆ°è¿™æŠŠå¯¹è±¡é”ï¼Œä»è€Œæ‰èƒ½è®¿é—® ä¸´ç•ŒåŒºçš„ä»£ç ï¼Œè®¿é—®ç»“æŸåï¼Œå°±ä¼šé‡Šæ”¾é”ï¼Œä¸‹ä¸€ä¸ªçº¿ç¨‹æ‰æœ‰å¯èƒ½è·å–é”æ¥è®¿é—®ä¸´ç•ŒåŒºï¼ˆè¢«é”ä½çš„ä»£ç åŒºåŸŸï¼‰ã€‚</p> <blockquote><p>synchronizedé” æ ¹æ®é”çš„èŒƒå›´åˆ†ä¸º å¯¹è±¡é” å’Œ ç±»é”ã€‚<br>
å¯¹è±¡é”ï¼Œæ˜¯ä»¥å¯¹è±¡å®ä¾‹ä¸ºé”ï¼Œå½“å¤šä¸ªçº¿ç¨‹å…±äº«è®¿é—®è¿™ä¸ªå¯¹è±¡å®ä¾‹ä¸‹çš„ä¸´ç•ŒåŒºï¼Œåªéœ€è¦ç«äº‰è¿™ä¸ªå¯¹è±¡å®ä¾‹ä¾¿å¯ï¼Œä¸åŒå¯¹è±¡å®ä¾‹ä¸‹çš„ä¸´ç•ŒåŒºæ˜¯ä¸ç”¨äº’æ–¥è®¿é—®ï¼›<br>
ç±»é”ï¼Œåˆ™æ˜¯ä»¥ç±»çš„classå¯¹è±¡ä¸ºé”ï¼Œè¿™ä¸ªé”ä¸‹çš„ä¸´ç•ŒåŒºï¼Œæ‰€æœ‰çº¿ç¨‹éƒ½å¿…é¡»äº’æ–¥è®¿é—®ï¼Œå°½ç®¡æ˜¯ä½¿ç”¨äº†ä¸åŒçš„å¯¹è±¡å®ä¾‹</p></blockquote> <blockquote><p>ä¸´ç•ŒåŒºå°±æ˜¯åœ¨åŒä¸€æ—¶åˆ»åªèƒ½æœ‰ä¸€ä¸ªä»»åŠ¡è®¿é—®çš„ä»£ç åŒº</p></blockquote></li></ol> <h4 id="åŒæ­¥ä»£ç å—"><a href="#åŒæ­¥ä»£ç å—" class="header-anchor">#</a> åŒæ­¥ä»£ç å—</h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">fun</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">synchronized</span><span class="token punctuation">(</span> object <span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token comment">//ä»£ç å—ï¼Œä¸€æ¬¡åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹è¿›å…¥</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ol><li><p>object æ˜¯ thisï¼Œæ˜¯å¯¹è±¡é”ï¼ŒthisæŒ‡ä»£å½“å‰å¯¹è±¡</p></li> <li><p>object æ˜¯ä¸€ä¸ªæ™®é€šå¯¹è±¡å®ä¾‹</p> <blockquote><p>å¦‚æœæ˜¯é™æ€å¯¹è±¡ï¼Œé‚£ä¹ˆå°±æ˜¯ ç±»é”ï¼›<br>
å¦‚æœæ˜¯éé™æ€å¯¹è±¡ï¼šæˆå‘˜å¯¹è±¡å˜é‡ã€å±€éƒ¨å˜é‡ï¼ˆç”šè‡³å¯ä»¥æ˜¯ æ–¹æ³•å‚æ•°ï¼‰ï¼Œé‚£ä¹ˆå°±æ˜¯å¯¹è±¡é”</p></blockquote></li> <li><p>object æ˜¯ä¸€ä¸ªç±»çš„class å¯¹è±¡ï¼Œé‚£ä¹ˆå°±æ˜¯ç±»é”</p></li></ol> <h4 id="volatile"><a href="#volatile" class="header-anchor">#</a> volatile</h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token keyword">volatile</span> <span class="token keyword">int</span> account <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>volatileå…³é”®å­—ä¸ºåŸŸå˜é‡çš„è®¿é—®æä¾›äº†ä¸€ç§å…é”æœºåˆ¶ï¼›</li> <li>ä½¿ç”¨volatileä¿®é¥°åŸŸç›¸å½“äºå‘Šè¯‰è™šæ‹Ÿæœºè¯¥åŸŸå¯èƒ½ä¼šè¢«å…¶ä»–çº¿ç¨‹æ›´æ–°ï¼›</li> <li>å› æ­¤æ¯æ¬¡ä½¿ç”¨è¯¥åŸŸå°±è¦é‡æ–°è®¡ç®—ï¼Œè€Œä¸æ˜¯ä½¿ç”¨å¯„å­˜å™¨ä¸­çš„å€¼ï¼›</li> <li>volatileä¸ä¼šæä¾›ä»»ä½•åŸå­æ“ä½œï¼Œå®ƒä¹Ÿä¸èƒ½ç”¨æ¥ä¿®é¥°finalç±»å‹çš„å˜é‡ã€‚</li></ul> <h4 id="é‡å…¥é”-lock"><a href="#é‡å…¥é”-lock" class="header-anchor">#</a> é‡å…¥é”ï¼ˆLockï¼‰</h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">ReentrantLock</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> åˆ›å»ºä¸€ä¸ª<span class="token class-name">ReentrantLock</span>å®ä¾‹         
<span class="token function">lock</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> è·å¾—é”        
<span class="token function">unlock</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> é‡Šæ”¾é”
</code></pre></div><h5 id="å…¬å¹³é”-éå…¬å¹³é”-å¤šçº¿ç¨‹æ‰§è¡Œé¡ºåºçš„ç»´åº¦"><a href="#å…¬å¹³é”-éå…¬å¹³é”-å¤šçº¿ç¨‹æ‰§è¡Œé¡ºåºçš„ç»´åº¦" class="header-anchor">#</a> å…¬å¹³é”/éå…¬å¹³é”ï¼ˆå¤šçº¿ç¨‹æ‰§è¡Œé¡ºåºçš„ç»´åº¦ï¼‰</h5> <ul><li>å…¬å¹³é”ï¼šåŠ é”å‰å…ˆæŸ¥çœ‹æ˜¯å¦æœ‰æ’é˜Ÿç­‰å¾…çš„çº¿ç¨‹ï¼Œæœ‰çš„è¯ä¼˜å…ˆå¤„ç†æ’åœ¨å‰é¢çš„çº¿ç¨‹ï¼Œå…ˆæ¥å…ˆå¾—ã€‚</li> <li>éå…¬å¹³æ‰€ï¼šçº¿ç¨‹åŠ é”æ—¶ç›´æ¥å°è¯•è·å–é”ï¼Œè·å–ä¸åˆ°å°±è‡ªåŠ¨åˆ°é˜Ÿå°¾ç­‰å¾…ã€‚</li></ul> <div class="language- extra-class"><pre class="language-text"><code>//åˆ›å»ºä¸€ä¸ªéå…¬å¹³é”ï¼Œé»˜è®¤æ˜¯éå…¬å¹³é”

Lock nonFairLock= new ReentrantLock();

Lock nonFairLock= new ReentrantLock(false);

//åˆ›å»ºä¸€ä¸ªå…¬å¹³é”ï¼Œæ„é€ ä¼ å‚true

Lock fairLock= new ReentrantLock(true);
</code></pre></div><h5 id="ä¹è§‚é”-æ‚²è§‚é”-å¤šçº¿ç¨‹æ“ä½œå…±äº«æ•°æ®çš„ç»´åº¦"><a href="#ä¹è§‚é”-æ‚²è§‚é”-å¤šçº¿ç¨‹æ“ä½œå…±äº«æ•°æ®çš„ç»´åº¦" class="header-anchor">#</a> ä¹è§‚é”/æ‚²è§‚é”ï¼ˆå¤šçº¿ç¨‹æ“ä½œå…±äº«æ•°æ®çš„ç»´åº¦ï¼‰</h5> <ul><li>æ‚²è§‚é”ï¼šå‡è®¾ä¸€å®šä¼šå‘ç”Ÿå¹¶å‘å†²çªï¼Œé€šè¿‡é˜»å¡å…¶ä»–æ‰€æœ‰çº¿ç¨‹æ¥ä¿è¯æ•°æ®çš„å®Œæ•´æ€§ã€‚</li> <li>ä¹è§‚é”ï¼šå‡è®¾ä¸ä¼šå‘ç”Ÿå¹¶å‘å†²çªï¼Œç›´æ¥ä¸åŠ é”å»å®ŒæˆæŸé¡¹æ›´æ–°ï¼Œå¦‚æœå†²çªå°±è¿”å›å¤±è´¥ã€‚</li></ul> <h3 id="çº¿ç¨‹é€šä¿¡"><a href="#çº¿ç¨‹é€šä¿¡" class="header-anchor">#</a> çº¿ç¨‹é€šä¿¡</h3> <h4 id="objectç±»çš„-wait-ã€notify-ã€notifyall"><a href="#objectç±»çš„-wait-ã€notify-ã€notifyall" class="header-anchor">#</a> Objectç±»çš„ wait()ã€notify()ã€notifyAll()</h4> <ul><li>çº¿ç¨‹æ‰§è¡Œwait()åï¼Œå°±æ”¾å¼ƒäº†è¿è¡Œèµ„æ ¼ï¼Œå¤„äºå†»ç»“çŠ¶æ€ï¼›</li> <li>çº¿ç¨‹è¿è¡Œæ—¶ï¼Œå†…å­˜ä¸­ä¼šå»ºç«‹ä¸€ä¸ªçº¿ç¨‹æ± ï¼Œå†»ç»“çŠ¶æ€çš„çº¿ç¨‹éƒ½å­˜åœ¨äºçº¿ç¨‹æ± ä¸­ï¼Œnotify()æ‰§è¡Œæ—¶å”¤é†’çš„ä¹Ÿæ˜¯çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹ï¼Œçº¿ç¨‹æ± ä¸­æœ‰å¤šä¸ªçº¿ç¨‹æ—¶å”¤é†’ç¬¬ä¸€ä¸ªè¢«å†»ç»“çš„çº¿ç¨‹ã€‚</li> <li>notifyall(), å”¤é†’çº¿ç¨‹æ± ä¸­æ‰€æœ‰çº¿ç¨‹ã€‚</li></ul> <h4 id="conditionæ§åˆ¶çº¿ç¨‹é€šä¿¡"><a href="#conditionæ§åˆ¶çº¿ç¨‹é€šä¿¡" class="header-anchor">#</a> Conditionæ§åˆ¶çº¿ç¨‹é€šä¿¡</h4> <ul><li>å°†åŒæ­¥synchronizedæ›¿æ¢ä¸ºæ˜¾å¼çš„Lockæ“ä½œï¼›</li> <li>å°†Objectç±»ä¸­çš„wait(), notify(),notifyAll()æ›¿æ¢æˆäº†Conditionå¯¹è±¡ï¼Œè¯¥å¯¹è±¡å¯ä»¥é€šè¿‡Locké”å¯¹è±¡è·å–;</li> <li>ä¸€ä¸ªLockå¯¹è±¡ä¸Šå¯ä»¥ç»‘å®šå¤šä¸ªConditionå¯¹è±¡ï¼Œè¿™æ ·å®ç°äº†æœ¬æ–¹çº¿ç¨‹åªå”¤é†’å¯¹æ–¹çº¿ç¨‹ï¼Œè€Œjdk1.5ä¹‹å‰ï¼Œä¸€ä¸ªåŒæ­¥åªèƒ½æœ‰ä¸€ä¸ªé”ï¼Œä¸åŒçš„åŒæ­¥åªèƒ½ç”¨é”æ¥åŒºåˆ†ï¼Œä¸”é”åµŒå¥—æ—¶å®¹æ˜“æ­»é”ã€‚</li></ul> <h4 id="é˜»å¡é˜Ÿåˆ—-blockingqueue-æ§åˆ¶çº¿ç¨‹é€šä¿¡"><a href="#é˜»å¡é˜Ÿåˆ—-blockingqueue-æ§åˆ¶çº¿ç¨‹é€šä¿¡" class="header-anchor">#</a> é˜»å¡é˜Ÿåˆ—ï¼ˆBlockingQueueï¼‰æ§åˆ¶çº¿ç¨‹é€šä¿¡</h4> <p>BlockingQueueæ˜¯ä¸€ä¸ªæ¥å£ï¼Œä¹Ÿæ˜¯Queueçš„å­æ¥å£ã€‚<br>
BlockingQueueå…·æœ‰ä¸€ä¸ªç‰¹å¾ï¼šå½“ç”Ÿäº§è€…çº¿ç¨‹è¯•å›¾å‘BlockingQueueä¸­æ”¾å…¥å…ƒç´ æ—¶ï¼Œå¦‚æœè¯¥é˜Ÿåˆ—å·²æ»¡ï¼Œåˆ™çº¿ç¨‹è¢«é˜»å¡ï¼›ä½†æ¶ˆè´¹è€…çº¿ç¨‹è¯•å›¾ä»BlockingQueueä¸­å–å‡ºå…ƒç´ æ—¶ï¼Œå¦‚æœé˜Ÿåˆ—å·²ç©ºï¼Œåˆ™è¯¥çº¿ç¨‹é˜»å¡ã€‚ç¨‹åºçš„ä¸¤ä¸ªçº¿ç¨‹é€šè¿‡äº¤æ›¿å‘BlockingQueueä¸­æ”¾å…¥å…ƒç´ ã€å–å‡ºå…ƒç´ ï¼Œå³å¯å¾ˆå¥½åœ°æ§åˆ¶çº¿ç¨‹çš„é€šä¿¡ã€‚</p> <p>BlockingQueueæä¾›å¦‚ä¸‹ä¸¤ä¸ªæ”¯æŒé˜»å¡çš„æ–¹æ³•ï¼š</p> <p>ï¼ˆ1ï¼‰put(E e)ï¼šå°è¯•æŠŠEuå…ƒç´ æ”¾å¦‚BlockingQueueä¸­ï¼Œå¦‚æœè¯¥é˜Ÿåˆ—çš„å…ƒç´ å·²æ»¡ï¼Œåˆ™é˜»å¡è¯¥çº¿ç¨‹ã€‚<br>
ï¼ˆ2ï¼‰takeï¼ˆï¼‰ï¼šå°è¯•ä»BlockingQueueçš„å¤´éƒ¨å–å‡ºå…ƒç´ ï¼Œå¦‚æœè¯¥é˜Ÿåˆ—çš„å…ƒç´ å·²ç©ºï¼Œåˆ™é˜»å¡è¯¥çº¿ç¨‹ã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>ArrayBlockingQueue ï¼šåŸºäºæ•°ç»„å®ç°çš„BlockingQueueé˜Ÿåˆ—ã€‚
LinkedBlockingQueueï¼šåŸºäºé“¾è¡¨å®ç°çš„BlockingQueueé˜Ÿåˆ—ã€‚
PriorityBlockingQueueï¼šå®ƒå¹¶ä¸æ˜¯ä¿å‡†çš„é˜»å¡é˜Ÿåˆ—ï¼Œè¯¥é˜Ÿåˆ—è°ƒç”¨removeï¼ˆï¼‰ã€pollï¼ˆï¼‰ã€takeï¼ˆï¼‰ç­‰æ–¹æ³•æå–å‡ºå…ƒç´ æ—¶ï¼Œå¹¶ä¸æ˜¯å–å‡ºé˜Ÿåˆ—ä¸­å­˜åœ¨æ—¶é—´æœ€é•¿çš„å…ƒç´ ï¼Œè€Œæ˜¯é˜Ÿåˆ—ä¸­æœ€å°çš„å…ƒç´ ã€‚
                       å®ƒåˆ¤æ–­å…ƒç´ çš„å¤§å°å³å¯æ ¹æ®å…ƒç´ ï¼ˆå®ç°Comparableæ¥å£ï¼‰çš„æœ¬èº«å¤§å°æ¥è‡ªç„¶æ’åºï¼Œä¹Ÿå¯ä½¿ç”¨Comparatorè¿›è¡Œå®šåˆ¶æ’åºã€‚
SynchronousQueueï¼šåŒæ­¥é˜Ÿåˆ—ã€‚å¯¹è¯¥é˜Ÿåˆ—çš„å­˜ã€å–æ“ä½œå¿…é¡»äº¤æ›¿è¿›è¡Œã€‚
DelayQueueï¼šå®ƒæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„BlockingQueueï¼Œåº•å±‚åŸºäºPriorityBlockingQueueå®ç°ï¼Œä¸è¿‡ï¼ŒDelayQueueè¦æ±‚é›†åˆå…ƒç´ éƒ½å®ç°Delayæ¥å£ï¼ˆè¯¥æ¥å£é‡Œåªæœ‰ä¸€ä¸ªlong getDelayï¼ˆï¼‰æ–¹æ³•ï¼‰ï¼Œ
            DelayQueueæ ¹æ®é›†åˆå…ƒç´ çš„getDalayï¼ˆï¼‰æ–¹æ³•çš„è¿”å›å€¼è¿›è¡Œæ’åºã€‚
</code></pre></div><h4 id="threadlocal"><a href="#threadlocal" class="header-anchor">#</a> ThreadLocal</h4> <p>æä¾›çº¿ç¨‹æœ¬åœ°å˜é‡ï¼Œå¦‚æœåˆ›å»ºä¸€ä¸ª <code>ThreadLocal</code> å˜é‡ï¼Œé‚£ä¹ˆè®¿é—®è¿™ä¸ªå˜é‡çš„æ¯ä¸ªçº¿ç¨‹éƒ½ä¼šæœ‰è¿™ä¸ªå˜é‡çš„ä¸€ä¸ªå‰¯æœ¬ï¼Œ
åœ¨å®é™…å¤šçº¿ç¨‹æ“ä½œçš„æ—¶å€™ï¼Œæ“ä½œçš„æ˜¯è‡ªå·±æœ¬åœ°å†…å­˜ä¸­çš„å˜é‡ï¼Œä»è€Œè§„é¿äº†çº¿ç¨‹å®‰å…¨é—®é¢˜</p> <p><img src="/docs.advanced.way/assets/img/1368768-20190614000329689-872917045.7fa44bab.png" alt=""></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ThreadLocal</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token keyword">int</span> threadLocalHashCode <span class="token operator">=</span> <span class="token function">nextHashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> HASH_INCREMENT <span class="token operator">=</span> <span class="token number">0x61c88647</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">AtomicInteger</span> nextHashCode <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AtomicInteger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">nextHashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> nextHashCode<span class="token punctuation">.</span><span class="token function">getAndAdd</span><span class="token punctuation">(</span>HASH_INCREMENT<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// </span>
    <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">ThreadLocalMap</span> <span class="token punctuation">{</span>
        <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Entry</span> <span class="token keyword">extends</span> <span class="token class-name">WeakReference</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ThreadLocal</span><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
            <span class="token class-name">Object</span> value<span class="token punctuation">;</span>

            <span class="token class-name">Entry</span><span class="token punctuation">(</span><span class="token class-name">ThreadLocal</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> k<span class="token punctuation">,</span> <span class="token class-name">Object</span> v<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">super</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">;</span>
                value <span class="token operator">=</span> v<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> INITIAL_CAPACITY <span class="token operator">=</span> <span class="token number">16</span><span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token class-name">Entry</span><span class="token punctuation">[</span><span class="token punctuation">]</span> table<span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token keyword">int</span> size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">private</span> <span class="token keyword">int</span> threshold<span class="token punctuation">;</span>

        <span class="token class-name">ThreadLocalMap</span><span class="token punctuation">(</span><span class="token class-name">ThreadLocal</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> firstKey<span class="token punctuation">,</span> <span class="token class-name">Object</span> firstValue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            table <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Entry</span><span class="token punctuation">[</span>INITIAL_CAPACITY<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> i <span class="token operator">=</span> firstKey<span class="token punctuation">.</span>threadLocalHashCode <span class="token operator">&amp;</span> <span class="token punctuation">(</span>INITIAL_CAPACITY <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// åˆ›å»ºèŠ‚ç‚¹å¹¶èµ‹å€¼</span>
            table<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Entry</span><span class="token punctuation">(</span>firstKey<span class="token punctuation">,</span> firstValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
            size <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token function">setThreshold</span><span class="token punctuation">(</span>INITIAL_CAPACITY<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">private</span> <span class="token class-name">Entry</span> <span class="token function">getEntry</span><span class="token punctuation">(</span><span class="token class-name">ThreadLocal</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">int</span> i <span class="token operator">=</span> key<span class="token punctuation">.</span>threadLocalHashCode <span class="token operator">&amp;</span> <span class="token punctuation">(</span>table<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Entry</span> e <span class="token operator">=</span> table<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>e <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> e<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> key<span class="token punctuation">)</span>
                <span class="token keyword">return</span> e<span class="token punctuation">;</span>
            <span class="token keyword">else</span>
                <span class="token keyword">return</span> <span class="token function">getEntryAfterMiss</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> i<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">set</span><span class="token punctuation">(</span><span class="token class-name">ThreadLocal</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> key<span class="token punctuation">,</span> <span class="token class-name">Object</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>

            <span class="token comment">// We don't use a fast path as with get() because it is at</span>
            <span class="token comment">// least as common to use set() to create new entries as</span>
            <span class="token comment">// it is to replace existing ones, in which case, a fast</span>
            <span class="token comment">// path would fail more often than not.</span>

            <span class="token class-name">Entry</span><span class="token punctuation">[</span><span class="token punctuation">]</span> tab <span class="token operator">=</span> table<span class="token punctuation">;</span>
            <span class="token keyword">int</span> len <span class="token operator">=</span> tab<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
            <span class="token keyword">int</span> i <span class="token operator">=</span> key<span class="token punctuation">.</span>threadLocalHashCode <span class="token operator">&amp;</span> <span class="token punctuation">(</span>len<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Entry</span> e <span class="token operator">=</span> tab<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
                 e <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
                 e <span class="token operator">=</span> tab<span class="token punctuation">[</span>i <span class="token operator">=</span> <span class="token function">nextIndex</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> len<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">ThreadLocal</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> k <span class="token operator">=</span> e<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token keyword">if</span> <span class="token punctuation">(</span>k <span class="token operator">==</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    e<span class="token punctuation">.</span>value <span class="token operator">=</span> value<span class="token punctuation">;</span>
                    <span class="token keyword">return</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>

                <span class="token keyword">if</span> <span class="token punctuation">(</span>k <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token function">replaceStaleEntry</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">return</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>

            tab<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Entry</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> sz <span class="token operator">=</span> <span class="token operator">++</span>size<span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">cleanSomeSlots</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> sz<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> sz <span class="token operator">&gt;=</span> threshold<span class="token punctuation">)</span>
                <span class="token function">rehash</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// æ‰©å®¹</span>
        <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">resize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">Entry</span><span class="token punctuation">[</span><span class="token punctuation">]</span> oldTab <span class="token operator">=</span> table<span class="token punctuation">;</span>
            <span class="token keyword">int</span> oldLen <span class="token operator">=</span> oldTab<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
            <span class="token keyword">int</span> newLen <span class="token operator">=</span> oldLen <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
            <span class="token class-name">Entry</span><span class="token punctuation">[</span><span class="token punctuation">]</span> newTab <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Entry</span><span class="token punctuation">[</span>newLen<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Entry</span> e <span class="token operator">:</span> oldTab<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>e <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token class-name">ThreadLocal</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> k <span class="token operator">=</span> e<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>k <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        e<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span> <span class="token comment">// Help the GC</span>
                    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                        <span class="token keyword">int</span> h <span class="token operator">=</span> k<span class="token punctuation">.</span>threadLocalHashCode <span class="token operator">&amp;</span> <span class="token punctuation">(</span>newLen <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword">while</span> <span class="token punctuation">(</span>newTab<span class="token punctuation">[</span>h<span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
                            h <span class="token operator">=</span> <span class="token function">nextIndex</span><span class="token punctuation">(</span>h<span class="token punctuation">,</span> newLen<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        newTab<span class="token punctuation">[</span>h<span class="token punctuation">]</span> <span class="token operator">=</span> e<span class="token punctuation">;</span>
                        count<span class="token operator">++</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>

            <span class="token function">setThreshold</span><span class="token punctuation">(</span>newLen<span class="token punctuation">)</span><span class="token punctuation">;</span>
            size <span class="token operator">=</span> count<span class="token punctuation">;</span>
            table <span class="token operator">=</span> newTab<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// åˆ›å»ºå®ä¾‹</span>
    <span class="token keyword">public</span> <span class="token class-name">ThreadLocal</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token class-name">ThreadLocalMap</span> <span class="token function">getMap</span><span class="token punctuation">(</span><span class="token class-name">Thread</span> t<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> t<span class="token punctuation">.</span>threadLocals<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">set</span><span class="token punctuation">(</span><span class="token class-name">T</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Thread</span> t <span class="token operator">=</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è·å–çº¿ç¨‹ threadLocals</span>
        <span class="token class-name">ThreadLocalMap</span> map <span class="token operator">=</span> <span class="token function">getMap</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>map <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// è®¾ç½®å€¼</span>
            map<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token function">createMap</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// åˆ›å»ºä¸€ä¸ª ThreadLocalMap</span>
    <span class="token keyword">void</span> <span class="token function">createMap</span><span class="token punctuation">(</span><span class="token class-name">Thread</span> t<span class="token punctuation">,</span> <span class="token class-name">T</span> firstValue<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        t<span class="token punctuation">.</span>threadLocals <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ThreadLocalMap</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> firstValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// è·å–å€¼</span>
    <span class="token keyword">public</span> <span class="token class-name">T</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Thread</span> t <span class="token operator">=</span> <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ThreadLocalMap</span> map <span class="token operator">=</span> <span class="token function">getMap</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>map <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// è·å–å®ä½“å…ƒç´ </span>
            <span class="token class-name">ThreadLocalMap<span class="token punctuation">.</span>Entry</span> e <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">getEntry</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>e <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token annotation punctuation">@SuppressWarnings</span><span class="token punctuation">(</span><span class="token string">&quot;unchecked&quot;</span><span class="token punctuation">)</span>
                <span class="token comment">// è·å–å€¼</span>
                <span class="token class-name">T</span> result <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">T</span><span class="token punctuation">)</span>e<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
                <span class="token keyword">return</span> result<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token function">setInitialValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// ç§»é™¤</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
         <span class="token class-name">ThreadLocalMap</span> m <span class="token operator">=</span> <span class="token function">getMap</span><span class="token punctuation">(</span><span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">currentThread</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token keyword">if</span> <span class="token punctuation">(</span>m <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
             m<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
         <span class="token punctuation">}</span>
     <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="çº¿ç¨‹æ± "><a href="#çº¿ç¨‹æ± " class="header-anchor">#</a> çº¿ç¨‹æ± </h2> <p>åœ¨ä½¿ç”¨çº¿ç¨‹æ± ä¹‹åï¼Œåˆ›å»ºçº¿ç¨‹å˜æˆäº†ä»çº¿ç¨‹æ± è·å¾—ç©ºé—²çº¿ç¨‹ï¼Œå…³é—­çº¿ç¨‹å˜æˆäº†å‘çº¿ç¨‹æ± å½’è¿˜çº¿ç¨‹ã€‚<br>
å¥½å¤„:</p> <ul><li>é™ä½èµ„æºæ¶ˆè€—ã€‚é€šè¿‡é‡å¤åˆ©ç”¨å·²åˆ›å»ºçš„çº¿ç¨‹é™ä½çº¿ç¨‹åˆ›å»ºå’Œé”€æ¯é€ æˆçš„æ¶ˆè€—ã€‚</li> <li>æé«˜å“åº”é€Ÿåº¦ã€‚å½“ä»»åŠ¡åˆ°è¾¾æ—¶ï¼Œä»»åŠ¡å¯ä»¥ä¸éœ€è¦ç­‰åˆ°çº¿ç¨‹åˆ›å»ºå°±èƒ½ç«‹å³æ‰§è¡Œã€‚</li> <li>æé«˜çº¿ç¨‹çš„å¯ç®¡ç†æ€§ã€‚çº¿ç¨‹æ˜¯ç¨€ç¼ºèµ„æºï¼Œå¦‚æœæ— é™åˆ¶çš„åˆ›å»ºï¼Œä¸ä»…ä¼šæ¶ˆè€—ç³»ç»Ÿèµ„æºï¼Œè¿˜ä¼šé™ä½ç³»ç»Ÿçš„ç¨³å®šæ€§ï¼Œä½¿ç”¨çº¿ç¨‹æ± å¯ä»¥è¿›è¡Œç»Ÿä¸€çš„åˆ†é…ï¼Œè°ƒä¼˜å’Œç›‘æ§ã€‚</li></ul> <h3 id="å†…ç½®çº¿ç¨‹æ± "><a href="#å†…ç½®çº¿ç¨‹æ± " class="header-anchor">#</a> å†…ç½®çº¿ç¨‹æ± </h3> <p>DKå¹¶å‘åŒ…ä¸­æä¾›äº†ä¸€å¥—Executorçº¿ç¨‹æ± æ¡†æ¶ã€‚Executorsç±»ä¸ºçº¿ç¨‹æ± å·¥å‚ï¼Œé€šè¿‡Executorså¯ä»¥å–å¾—ä¸€ä¸ªæ‹¥æœ‰ç‰¹å®šåŠŸèƒ½çš„çº¿ç¨‹æ± </p> <p>Executorçº¿ç¨‹æ± æ¡†æ¶çš„æœ€å¤§ä¼˜ç‚¹æ˜¯æŠŠä»»åŠ¡çš„æäº¤å’Œæ‰§è¡Œè§£è€¦
<img src="/docs.advanced.way/assets/img/java-7-concurrent-executors-uml-class-diagram-example.0316d472.png" alt=""></p> <p>ä½¿ç”¨Executorsæ‰§è¡Œå¤šçº¿ç¨‹ä»»åŠ¡çš„æ­¥éª¤å¦‚ä¸‹ï¼š</p> <p>â€¢ è°ƒç”¨Executorsç±»çš„é™æ€å·¥å‚æ–¹æ³•åˆ›å»ºä¸€ä¸ªExecutorServiceå¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä»£è¡¨ä¸€ä¸ªçº¿ç¨‹æ± ï¼›</p> <p>â€¢ åˆ›å»ºRunnableå®ç°ç±»æˆ–Callableå®ç°ç±»çš„å®ä¾‹ï¼Œä½œä¸ºçº¿ç¨‹æ‰§è¡Œä»»åŠ¡ï¼›</p> <p>â€¢ è°ƒç”¨ExecutorServiceå¯¹è±¡çš„submit()æ–¹æ³•æ¥æäº¤Runnableå®ä¾‹æˆ–Callableå®ä¾‹ï¼›</p> <p>â€¢ å½“ä¸æƒ³æäº¤ä»»åŠ¡æ—¶ï¼Œè°ƒç”¨ExecutorServiceå¯¹è±¡çš„shutdown()æ–¹æ³•æ¥å…³é—­çº¿ç¨‹æ± </p> <p>newFixedThreadPool()ï¼šé€šè¿‡è¯¥å·¥å‚æ–¹æ³•è¿”å›ä¸€ä¸ªå›ºå®šçº¿ç¨‹æ•°é‡çš„çº¿ç¨‹æ± ã€‚çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°é‡å§‹ç»ˆä¸å˜ã€‚å½“æ²¡æœ‰ç©ºé—²çº¿ç¨‹æ—¶ï¼Œæ–°æäº¤çš„ä»»åŠ¡åˆ™è¢«æš‚å­˜åœ¨ä¸€ä¸ªä»»åŠ¡é˜Ÿåˆ—ä¸­ã€‚</p> <p>newSingleThreadExecutor()ï¼šé€šè¿‡è¯¥æ–¹æ³•è¿”å›ä¸€ä¸ªåªæœ‰ä¸€ä¸ªçº¿ç¨‹çš„çº¿ç¨‹æ± ã€‚å¤šä½™çš„ä»»åŠ¡è¢«ä¿å­˜åœ¨ä»»åŠ¡é˜Ÿåˆ—ä¸­ï¼Œå¾…çº¿ç¨‹ç©ºé—²ï¼ŒæŒ‰å…ˆè¿›å…ˆå‡ºçš„é¡ºåºæ‰§è¡Œé˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ã€‚</p> <p>newCachedThreadPool()ï¼šé€šè¿‡è¯¥æ–¹æ³•è¿”å›ä¸€ä¸ªå¯æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´çº¿ç¨‹æ•°é‡çš„çº¿ç¨‹æ± ã€‚çº¿ç¨‹æ± çš„çº¿ç¨‹æ•°é‡ä¸ç¡®å®šï¼Œå½“æ‰€æœ‰çº¿ç¨‹éƒ½åœ¨å·¥ä½œæ—¶ï¼Œåˆæœ‰æ–°çš„ä»»åŠ¡æäº¤ï¼Œåˆ™ä¼šåˆ›å»ºæ–°çš„çº¿ç¨‹æ¥å¤„ç†ä»»åŠ¡ã€‚æ‰€æœ‰çº¿ç¨‹åœ¨å½“å‰ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ä¹‹åï¼Œå°†è¿”å›çº¿ç¨‹æ± è¿›è¡Œå¤ç”¨ã€‚</p> <p>newSingleThreadScheduledExecutor()ï¼šé€šè¿‡è¯¥æ–¹æ³•è¿”å›ä¸€ä¸ªSheduledExecutorServiceå¯¹è±¡ï¼Œçº¿ç¨‹æ± å¤§å°ä¸º1ã€‚SheduledExecutorServiceæ¥å£åœ¨ExecutorServiceæ¥å£ä¸Šæ‰©å±•äº†åœ¨ç»™å®šæ—¶é—´æ‰§è¡ŒæŸä»»åŠ¡çš„åŠŸèƒ½ï¼Œå¦‚åœ¨æŸä¸ªå›ºå®šæ—¶å»¶ä¹‹åæ‰§è¡Œï¼Œæˆ–è€…å‘¨æœŸæ€§æ‰§è¡ŒæŸä¸ªä»»åŠ¡ã€‚</p> <p>newScheduledThreadPool()ï¼šé€šè¿‡è¯¥æ–¹æ³•è¿”å›ä¸€ä¸ªSheduledExecutorServiceçš„å¯¹è±¡ï¼Œä½†è¯¥çº¿ç¨‹æ± å¯ä»¥æŒ‡å®šçº¿ç¨‹æ•°é‡</p> <h3 id="çº¿ç¨‹æ± å‚æ•°"><a href="#çº¿ç¨‹æ± å‚æ•°" class="header-anchor">#</a> çº¿ç¨‹æ± å‚æ•°</h3> <p>å†…éƒ¨å®ç°å‡ä½¿ç”¨äº†ThreadPoolExecutorå®ç°ï¼Œéƒ½æ˜¯é€šè¿‡ThreadPoolExecutorç±»è¿›è¡Œå°è£…ä¹‹åå¾—åˆ°çš„ï¼Œå®é™…ä¸Šå°±æ˜¯åœ¨ThreadPoolExecutoræ„é€ å‡½æ•°ä¸­æŒ‡å®šä¸åŒçš„å‚æ•°æ¥æ„é€ ä¸åŒçš„çº¿ç¨‹æ± </p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">(</span>
			<span class="token keyword">int</span> corePoolSize<span class="token punctuation">,</span>
			<span class="token keyword">int</span> maxnumPoolSize<span class="token punctuation">,</span>
			<span class="token keyword">long</span> keepAliveTime<span class="token punctuation">,</span>
			<span class="token class-name">TimeUnit</span> unit<span class="token punctuation">,</span>
			<span class="token class-name">BlockingQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Runnable</span><span class="token punctuation">&gt;</span></span> workQueue<span class="token punctuation">,</span>
			<span class="token class-name">ThreadFactory</span> threadFactory<span class="token punctuation">,</span>
			<span class="token class-name">RejectedExecutionHandler</span> handler
			<span class="token punctuation">)</span>

</code></pre></div><ul><li>corePoolSize:æŒ‡å®šäº†çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°é‡ã€‚</li> <li>maxnumPoolSize:æŒ‡å®šäº†çº¿ç¨‹æ± ä¸­çš„æœ€å¤§çº¿ç¨‹æ•°é‡ã€‚</li> <li>keepAliveTime:å½“çº¿ç¨‹æ± çº¿ç¨‹æ•°é‡è¶…è¿‡corePoolSizeæ—¶ï¼Œå¤šä½™çš„ç©ºé—²çº¿ç¨‹çš„å­˜æ´»æ—¶é—´ï¼Œå³è¶…è¿‡corePoolSizeçš„ç©ºé—²çº¿ç¨‹åœ¨å¤šé•¿çš„æ—¶é—´å†…ä¼šè¢«é”€æ¯ã€‚</li> <li>unit: keepAliveTimeçš„å•ä½ã€‚</li> <li>workQueue:ä»»åŠ¡é˜Ÿåˆ—ï¼Œè¢«æäº¤ä½†å°šæœªè¢«æ‰§è¡Œçš„ä»»åŠ¡ã€‚</li> <li>threadFactory:çº¿ç¨‹å·¥å‚ï¼Œç”¨äºåˆ›å»ºçº¿ç¨‹ï¼Œä¸€èˆ¬ç”¨é»˜è®¤çš„å³å¯ã€‚</li> <li>handler:æ‹’ç»ç­–ç•¥ï¼Œå½“ä»»åŠ¡å¤ªå¤šæ¥ä¸åŠå¤„ç†æ—¶æ‹’ç»æ‰§è¡Œçš„ç­–ç•¥ã€‚</li></ul> <h4 id="ä»»åŠ¡é˜Ÿåˆ—"><a href="#ä»»åŠ¡é˜Ÿåˆ—" class="header-anchor">#</a> ä»»åŠ¡é˜Ÿåˆ—</h4> <p>å‚æ•°ä»»åŠ¡é˜Ÿåˆ—æŒ‡è¢«æäº¤ä½†æ˜¯æœªæ‰§è¡Œçš„é˜Ÿåˆ—ä»»åŠ¡ï¼Œå®ƒæ˜¯ä¸€ä¸ªBlockingQueueæ¥å£çš„å¯¹è±¡ï¼Œç”¨äºå­˜æ”¾Runnableå¯¹è±¡</p> <p>(1)	ç›´æ¥æäº¤çš„é˜Ÿåˆ—ï¼šè¯¥åŠŸèƒ½ç”±SynchronizedQueueå¯¹è±¡æä¾›ã€‚SynchronizedQueueæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„é˜»å¡é˜Ÿåˆ—ã€‚SynchronizedQueueæ²¡æœ‰å®¹é‡ï¼Œæ¯ä¸€ä¸ªæ’å…¥æ“ä½œéƒ½è¦ç­‰å¾…ä¸€ä¸ªç›¸åº”çš„åˆ é™¤æ“ä½œï¼Œåä¹‹æ¯ä¸€ä¸ªåˆ é™¤æ“ä½œéƒ½éœ€è¦ç­‰å¾…å¯¹åº”çš„æ’å…¥æ“ä½œã€‚ä½¿ç”¨SynchronizedQueueæ—¶æäº¤çš„ä»»åŠ¡ä¸ä¼šè¢«çœŸå®çš„ä¿å­˜ï¼Œè€Œæ€»æ˜¯å°†æ–°ä»»åŠ¡æäº¤ç»™çº¿ç¨‹æ‰§è¡Œï¼Œå¦‚æœæ²¡æœ‰ç©ºé—²çš„çº¿ç¨‹åˆ™å°è¯•åˆ›å»ºæ–°çš„çº¿ç¨‹ï¼Œå¦‚æœçº¿ç¨‹æ•°é‡è¾¾åˆ°æœ€å¤§å€¼å°±æ‰§è¡Œå†³ç»ç­–ç•¥ã€‚ä½¿ç”¨SynchronizedQueueé˜Ÿåˆ—é€šå¸¸è¦è®¾ç½®å¾ˆå¤§çš„maxnumPoolSizeï¼Œå¦åˆ™å¾ˆå®¹æ˜“æ‰§è¡Œæ‹’ç»ç­–ç•¥ã€‚å¯ä»¥å½“åšå¤§å°ä¸º0çš„é˜Ÿåˆ—æ¥ç†è§£ã€‚</p> <p>(2)	æœ‰ç•Œçš„ä»»åŠ¡é˜Ÿåˆ—ï¼šæœ‰ç•Œçš„ä»»åŠ¡é˜Ÿåˆ—å¯ä»¥ä½¿ç”¨ArrayBlockingQueueå®ç°ã€‚å½“ä½¿ç”¨æœ‰ç•Œçš„ä»»åŠ¡é˜Ÿåˆ—æ—¶ï¼Œè‹¥æœ‰æ–°çš„ä»»åŠ¡éœ€è¦æ‰§è¡Œï¼Œå¦‚æœçº¿ç¨‹æ± çš„å®é™…çº¿ç¨‹æ•°å°äºæ ¸å¿ƒçº¿ç¨‹æ•°ï¼Œåˆ™æœ‰ä¼˜å…ˆåˆ›å»ºæ–°çš„çº¿ç¨‹ï¼Œè‹¥å¤§äºæ ¸å¿ƒçº¿ç¨‹æ•°ï¼Œåˆ™ä¼šå°†æ–°ä»»åŠ¡åŠ å…¥ç­‰å¾…é˜Ÿåˆ—ã€‚è‹¥é˜Ÿåˆ—å·²æ»¡ï¼Œæ— æ³•åŠ å…¥åˆ™åœ¨æ€»çº¿ç¨‹æ•°ä¸å¤§äºæœ€å¤§çº¿ç¨‹æ•°çš„å‰æä¸‹ï¼Œåˆ›å»ºæ–°çš„çº¿ç¨‹ã€‚è‹¥å¤§äºæœ€å¤§çº¿ç¨‹æ•°ï¼Œåˆ™æ‰§è¡Œæ‹’ç»ç­–ç•¥ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæœ‰ç•Œé˜Ÿåˆ—ä»…å½“ä»»åŠ¡é˜Ÿåˆ—æ»¡æ—¶æ‰å¯èƒ½å°†çº¿ç¨‹æ•°æå‡åˆ°æ ¸å¿ƒçº¿ç¨‹æ•°åªä¸Šï¼Œå¦åˆ™ç¡®ä¿çº¿ç¨‹æ•°ç»´æŒåœ¨æ ¸å¿ƒçº¿ç¨‹æ•°å¤§å°ã€‚</p> <p>(3)	æ— ç•Œä»»åŠ¡é˜Ÿåˆ—ï¼šæ— ç•Œä»»åŠ¡é˜Ÿåˆ—å¯ä»¥é€šè¿‡LinkedBlockingQueueç±»æ¥å®ç°ã€‚ä¸æœ‰ç•Œé˜Ÿåˆ—ç›¸æ¯”ï¼Œé™¤éç³»ç»Ÿèµ„æºè€—å°½ï¼Œå¦åˆ™æ— ç•Œé˜Ÿåˆ—ä¸å­˜åœ¨ä»»åŠ¡å…¥é˜Ÿå¤±è´¥çš„æƒ…å†µã€‚å½“æœ‰æ–°çš„ä»»åŠ¡åˆ°æ¥ï¼Œç³»ç»Ÿçš„çº¿ç¨‹æ•°å°äºæ ¸å¿ƒçº¿ç¨‹æ•°æ—¶çº¿ç¨‹æ± ä¼šç”Ÿæˆæ–°çš„çº¿ç¨‹æ‰§è¡Œä»»åŠ¡ï¼Œä½†å½“ç³»ç»Ÿçº¿ç¨‹æ•°å¤§äºæ ¸å¿ƒçº¿ç¨‹æ•°åï¼Œå°±ä¸ä¼šç»§ç»­å¢åŠ ã€‚è‹¥åç»­æœ‰æ–°çš„ä»»åŠ¡ï¼Œåˆ™å°†ä»»åŠ¡æ”¾å…¥æ— ç•Œé˜Ÿåˆ—ä¸­ç­‰å¾…ã€‚</p> <p>(4)	ä¼˜å…ˆä»»åŠ¡é˜Ÿåˆ—ï¼šä¼˜å…ˆä»»åŠ¡é˜Ÿåˆ—æ˜¯å¸¦æœ‰æ‰§è¡Œä¼˜å…ˆçº§çš„é˜Ÿåˆ—ï¼Œé€šè¿‡PriorityBlockingQueueå®ç°ï¼Œå¯ä»¥æ§åˆ¶ä»»åŠ¡çš„æ‰§è¡Œå…ˆåé¡ºåºï¼Œæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„æ— ç•Œé˜Ÿåˆ—ã€‚æ— è®ºæ˜¯æœ‰ç•Œé˜Ÿåˆ—è¿˜ArrayBlockingQueueè¿˜æ˜¯æœªæŒ‡å®šå¤§å°çš„æ— ç•Œé˜Ÿåˆ—LinkedBlockingQueueï¼Œéƒ½æ˜¯æŒ‰ç…§å…ˆè¿›å…ˆå‡ºç®—æ³•å¤„ç†ä»»åŠ¡çš„ï¼Œè€Œæœ‰é™é˜Ÿåˆ—åˆ™å¯ä»¥æ ¹æ®ä»»åŠ¡è‡ªèº«çš„ä¼˜å…ˆçº§é¡ºåºæ‰§è¡Œï¼Œåœ¨ç¡®ä¿ç³»ç»Ÿæ€§èƒ½çš„åŒæ—¶ï¼Œä¹Ÿèƒ½æœ‰å¾ˆå¥½çš„è´¨é‡ä¿è¯ã€‚</p> <h4 id="æ‹’ç»ç­–ç•¥"><a href="#æ‹’ç»ç­–ç•¥" class="header-anchor">#</a> æ‹’ç»ç­–ç•¥</h4> <p>å½“çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹å·²ç»ç”¨å®Œï¼Œæ— æ³•ç»§ç»­ä¸ºæ–°ä»»åŠ¡æœåŠ¡ï¼ŒåŒæ—¶ç­‰å¾…é˜Ÿåˆ—ä¸­å·²ç»æ’æ»¡ï¼Œå†ä¹Ÿå¡ä¸ä¸‹æ–°ä»»åŠ¡äº†</p> <ul><li>AbortPolicyï¼šè¯¥ç­–ç•¥ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œé˜»æ­¢ç³»ç»Ÿæ­£å¸¸å·¥ä½œã€‚</li> <li>CallerRunsPolicyï¼šåªè¦çº¿ç¨‹æ± æœªå…³é—­ï¼Œè¯¥ç­–ç•¥ç›´æ¥åœ¨è°ƒç”¨è€…çº¿ç¨‹ä¸­è¿è¡Œå½“å‰è¢«ä¸¢å¼ƒçš„ä»»åŠ¡ã€‚æ˜¾ç„¶è¿™æ ·åšä¸ä¼šçœŸçš„ä¸¢å¼ƒä»»åŠ¡ï¼Œä½†æ˜¯ä»»åŠ¡æäº¤çº¿ç¨‹çš„æ€§èƒ½å¯èƒ½ä¼šæ€¥å‰§ä¸‹é™ã€‚</li> <li>DiscardOledestPolicyï¼šè¯¥ç­–ç•¥å°†ä¸¢å¼ƒæœ€è€çš„ä¸€ä¸ªè¯·æ±‚ï¼Œä¹Ÿå°±æ˜¯å³å°†è¢«æ‰§è¡Œçš„ä¸€ä¸ªä»»åŠ¡ï¼Œå¹¶å°è¯•å†æ¬¡æäº¤å½“å‰ä»»åŠ¡ã€‚</li> <li>DiscardPolicyï¼šè¯¥ç­–ç•¥é»˜é»˜ä¸¢å¼ƒæ— æ³•å¤„ç†çš„ä»»åŠ¡ï¼Œä¸äºˆä»»ä½•å¤„ç†ã€‚åœ¨å…è®¸ä»»åŠ¡ä¸¢å¤±çš„æƒ…å†µä¸‹è¿™æ˜¯ä¸€ç§åˆé€‚çš„æ–¹æ¡ˆã€‚</li></ul> <p>ä»¥ä¸Šå†…ç½®çš„ç­–ç•¥å‡å®ç°äº†RejectedExecutionHandleræ¥å£ï¼Œè‹¥ä»æ— æ³•æ»¡è¶³å®é™…éœ€è¦ï¼Œå¯ä»¥è‡ªå·±æ‰©å±•RejectedExecutionHandleræ¥å£ï¼Œé€šè¿‡å¤å†™rejectedExecutionæ–¹æ³•ï¼Œæ¥å®ç°è‡ªå·±é¥¿æ‹’ç»ç­–ç•¥</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span>
    			<span class="token number">0L</span><span class="token punctuation">,</span><span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>MICROSECONDS<span class="token punctuation">,</span>
    			<span class="token keyword">new</span> <span class="token class-name">LinkedBlockingQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Runnable</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    			<span class="token class-name">Executors</span><span class="token punctuation">.</span><span class="token function">defaultThreadFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    			<span class="token keyword">new</span> <span class="token class-name">RejectedExecutionHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    				<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">rejected</span><span class="token punctuation">(</span><span class="token class-name">Runnable</span> r<span class="token punctuation">,</span> <span class="token class-name">ThreadPoolExecutor</span> executor<span class="token punctuation">)</span> <span class="token punctuation">{</span>	 
    				  <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;is discard&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                                                          
    				<span class="token punctuation">}</span>
    			<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h4 id="çº¿ç¨‹æ± æ‰©å±•"><a href="#çº¿ç¨‹æ± æ‰©å±•" class="header-anchor">#</a> çº¿ç¨‹æ± æ‰©å±•</h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">ExecutorService</span> eService <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ThreadPoolExecutor</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span>
		<span class="token number">0L</span><span class="token punctuation">,</span><span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>MICROSECONDS<span class="token punctuation">,</span>
		<span class="token keyword">new</span> <span class="token class-name">LinkedBlockingQueue</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Runnable</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token class-name">Executors</span><span class="token punctuation">.</span><span class="token function">defaultThreadFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
		<span class="token keyword">new</span> <span class="token class-name">RejectedExecutionHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">rejectedExecution</span><span class="token punctuation">(</span><span class="token class-name">Runnable</span> r<span class="token punctuation">,</span> <span class="token class-name">ThreadPoolExecutor</span> executor<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">&quot;is discard&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		    <span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token annotation punctuation">@Override</span>
			<span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">beforeExecute</span><span class="token punctuation">(</span><span class="token class-name">Thread</span> thread <span class="token punctuation">,</span><span class="token class-name">Runnable</span> r<span class="token punctuation">)</span><span class="token punctuation">{</span>
				<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;å‡†å¤‡æ‰§è¡Œ&quot;</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">MyTask</span><span class="token punctuation">)</span>r<span class="token punctuation">)</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			
			<span class="token annotation punctuation">@Override</span>
			<span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">afterExecute</span><span class="token punctuation">(</span><span class="token class-name">Runnable</span> r<span class="token punctuation">,</span><span class="token class-name">Throwable</span> t<span class="token punctuation">)</span><span class="token punctuation">{</span>
				<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;æ‰§è¡Œå®Œæˆ&quot;</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">MyTask</span><span class="token punctuation">)</span>r<span class="token punctuation">)</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="executorserviceæœ‰å¦‚ä¸‹å‡ ä¸ªæ‰§è¡Œæ–¹æ³•"><a href="#executorserviceæœ‰å¦‚ä¸‹å‡ ä¸ªæ‰§è¡Œæ–¹æ³•" class="header-anchor">#</a> ExecutorServiceæœ‰å¦‚ä¸‹å‡ ä¸ªæ‰§è¡Œæ–¹æ³•</h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token operator">-</span> <span class="token function">execute</span><span class="token punctuation">(</span><span class="token class-name">Runnable</span><span class="token punctuation">)</span>
<span class="token operator">-</span> <span class="token function">submit</span><span class="token punctuation">(</span><span class="token class-name">Runnable</span><span class="token punctuation">)</span>
<span class="token operator">-</span> <span class="token function">submit</span><span class="token punctuation">(</span><span class="token class-name">Callable</span><span class="token punctuation">)</span>
<span class="token operator">-</span> <span class="token function">invokeAny</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
<span class="token operator">-</span> <span class="token function">invokeAll</span><span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
</code></pre></div><h5 id="submit-runnable"><a href="#submit-runnable" class="header-anchor">#</a> submit(Runnable)</h5> <p>submit(Runnable)å’Œexecute(Runnable)åŒºåˆ«æ˜¯å‰è€…å¯ä»¥è¿”å›ä¸€ä¸ªFutureå¯¹è±¡ï¼Œé€šè¿‡è¿”å›çš„Futureå¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥æ£€æŸ¥æäº¤çš„ä»»åŠ¡æ˜¯å¦æ‰§è¡Œå®Œæ¯•ï¼Œè¯·çœ‹ä¸‹é¢æ‰§è¡Œçš„ä¾‹å­ï¼š</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">Future</span> future <span class="token operator">=</span> executorService<span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Runnable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Asynchronous task&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

future<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//returns null if the task has finished correctly.</span>
</code></pre></div><blockquote><p>æ³¨ï¼šå¦‚æœä»»åŠ¡æ‰§è¡Œå®Œæˆï¼Œfuture.get()æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªnullã€‚æ³¨æ„ï¼Œfuture.get()æ–¹æ³•ä¼šäº§ç”Ÿé˜»å¡ã€‚</p></blockquote> <h5 id="invokeany"><a href="#invokeany" class="header-anchor">#</a> invokeAny(â€¦)</h5> <p>invokeAny(...)æ–¹æ³•æ¥æ”¶çš„æ˜¯ä¸€ä¸ªCallableçš„é›†åˆï¼Œæ‰§è¡Œè¿™ä¸ªæ–¹æ³•ä¸ä¼šè¿”å›Futureï¼Œä½†æ˜¯ä¼šè¿”å›æ‰€æœ‰Callableä»»åŠ¡ä¸­å…¶ä¸­ä¸€ä¸ªä»»åŠ¡çš„æ‰§è¡Œç»“æœã€‚è¿™ä¸ªæ–¹æ³•ä¹Ÿæ— æ³•ä¿è¯è¿”å›çš„æ˜¯å“ªä¸ªä»»åŠ¡çš„æ‰§è¡Œç»“æœï¼Œåæ­£æ˜¯å…¶ä¸­çš„æŸä¸€ä¸ª</p> <h5 id="invokeall"><a href="#invokeall" class="header-anchor">#</a> invokeAll(â€¦)</h5> <p>invokeAll(...)ä¸ invokeAny(...)ç±»ä¼¼ä¹Ÿæ˜¯æ¥æ”¶ä¸€ä¸ªCallableé›†åˆï¼Œä½†æ˜¯å‰è€…æ‰§è¡Œä¹‹åä¼šè¿”å›ä¸€ä¸ªFutureçš„Listï¼Œå…¶ä¸­å¯¹åº”ç€æ¯ä¸ªCallableä»»åŠ¡æ‰§è¡Œåçš„Futureå¯¹è±¡</p> <h5 id="executorserviceå…³é—­æ–¹æ³•"><a href="#executorserviceå…³é—­æ–¹æ³•" class="header-anchor">#</a> ExecutorServiceå…³é—­æ–¹æ³•</h5> <p>å½“æˆ‘ä»¬ä½¿ç”¨å®ŒæˆExecutorServiceä¹‹ååº”è¯¥å…³é—­å®ƒï¼Œå¦åˆ™å®ƒé‡Œé¢çš„çº¿ç¨‹ä¼šä¸€ç›´å¤„äºè¿è¡ŒçŠ¶æ€ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœçš„åº”ç”¨ç¨‹åºæ˜¯é€šè¿‡main()æ–¹æ³•å¯åŠ¨çš„ï¼Œåœ¨è¿™ä¸ªmain()é€€å‡ºä¹‹åï¼Œå¦‚æœåº”ç”¨ç¨‹åºä¸­çš„ExecutorServiceæ²¡æœ‰å…³é—­ï¼Œè¿™ä¸ªåº”ç”¨å°†ä¸€ç›´è¿è¡Œã€‚ä¹‹æ‰€ä»¥ä¼šå‡ºç°è¿™ç§æƒ…å†µï¼Œæ˜¯å› ä¸ºExecutorServiceä¸­è¿è¡Œçš„çº¿ç¨‹ä¼šé˜»æ­¢JVMå…³é—­ã€‚</p> <p>è¦å…³é—­ExecutorServiceä¸­æ‰§è¡Œçš„çº¿ç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥è°ƒç”¨ExecutorService.shutdown()æ–¹æ³•ã€‚åœ¨è°ƒç”¨shutdown()æ–¹æ³•ä¹‹åï¼ŒExecutorServiceä¸ä¼šç«‹å³å…³é—­ï¼Œä½†æ˜¯å®ƒä¸å†æ¥æ”¶æ–°çš„ä»»åŠ¡ï¼Œç›´åˆ°å½“å‰æ‰€æœ‰çº¿ç¨‹æ‰§è¡Œå®Œæˆæ‰ä¼šå…³é—­ï¼Œæ‰€æœ‰åœ¨shutdown()æ‰§è¡Œä¹‹å‰æäº¤çš„ä»»åŠ¡éƒ½ä¼šè¢«æ‰§è¡Œã€‚</p> <p>å¦‚æœæƒ³ç«‹å³å…³é—­ExecutorServiceï¼Œæˆ‘ä»¬å¯ä»¥è°ƒç”¨ExecutorService.shutdownNow()æ–¹æ³•ã€‚è¿™ä¸ªåŠ¨ä½œå°†è·³è¿‡æ‰€æœ‰æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡å’Œè¢«æäº¤è¿˜æ²¡æœ‰æ‰§è¡Œçš„ä»»åŠ¡ã€‚ä½†æ˜¯å®ƒå¹¶ä¸å¯¹æ­£åœ¨æ‰§è¡Œçš„ä»»åŠ¡åšä»»ä½•ä¿è¯ï¼Œæœ‰å¯èƒ½å®ƒä»¬éƒ½ä¼šåœæ­¢ï¼Œä¹Ÿæœ‰å¯èƒ½æ‰§è¡Œå®Œæˆã€‚</p> <h3 id="æ­»é”"><a href="#æ­»é”" class="header-anchor">#</a> æ­»é”</h3> <h4 id="æ­»é”çš„å››ä¸ªå¿…è¦æ¡ä»¶"><a href="#æ­»é”çš„å››ä¸ªå¿…è¦æ¡ä»¶" class="header-anchor">#</a> æ­»é”çš„å››ä¸ªå¿…è¦æ¡ä»¶</h4> <ul><li>äº’æ–¥æ¡ä»¶ï¼šèµ„æºä¸èƒ½è¢«å…±äº«ï¼Œåªèƒ½è¢«åŒä¸€ä¸ªè¿›ç¨‹ä½¿ç”¨</li> <li>è¯·æ±‚ä¸ä¿æŒæ¡ä»¶ï¼šå·²ç»å¾—åˆ°èµ„æºçš„è¿›ç¨‹å¯ä»¥ç”³è¯·æ–°çš„èµ„æº</li> <li>éå‰¥å¤ºæ¡ä»¶ï¼šå·²ç»åˆ†é…çš„èµ„æºä¸èƒ½ä»ç›¸åº”çš„è¿›ç¨‹ä¸­è¢«å¼ºåˆ¶å‰¥å¤º</li> <li>å¾ªç¯ç­‰å¾…æ¡ä»¶ï¼šç³»ç»Ÿä¸­è‹¥å¹²è¿›ç¨‹ç»„æˆç¯è·¯ï¼Œè¯¥ç¯è·¯ä¸­æ¯ä¸ªè¿›ç¨‹éƒ½åœ¨ç­‰å¾…ç›¸é‚»è¿›ç¨‹å ç”¨çš„èµ„æº</li></ul> <h4 id="å¤„ç†æ­»é”çš„æ–¹æ³•"><a href="#å¤„ç†æ­»é”çš„æ–¹æ³•" class="header-anchor">#</a> å¤„ç†æ­»é”çš„æ–¹æ³•</h4> <ul><li>å¿½ç•¥è¯¥é—®é¢˜ï¼Œä¹Ÿå³é¸µé¸Ÿç®—æ³•ã€‚å½“å‘ç”Ÿäº†ä»€ä¹ˆé—®é¢˜æ—¶ï¼Œä¸ç®¡ä»–ï¼Œç›´æ¥è·³è¿‡ï¼Œæ— è§†å®ƒ;</li> <li>æ£€æµ‹æ­»é”å¹¶æ¢å¤;</li> <li>èµ„æºè¿›è¡ŒåŠ¨æ€åˆ†é…;</li> <li>ç ´é™¤ä¸Šé¢çš„å››ç§æ­»é”æ¡ä»¶ä¹‹ä¸€;</li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">æœ€åæ›´æ–°æ—¶é—´:</span> <span class="time">10/2/2020, 2:01:54 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      â†
      <a href="/docs.advanced.way/java/hc/é«˜å¹¶å‘.html" class="prev">
        é«˜å¹¶å‘
      </a></span> <span class="next"><a href="/docs.advanced.way/java/hc/å¹¶å‘ç¼–ç¨‹çš„è‰ºæœ¯.html">
        å¹¶å‘ç¼–ç¨‹çš„è‰ºæœ¯
      </a>
      â†’
    </span></p></div> </main> <aside class="tocSidebar"><div class="tocTitle">å½“å‰é¡µ</div> <ul class="tocSidebar-sub-headers"><li class="tocSidebar-sub-header"><a href="/docs.advanced.way/java/hc/%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#çº¿ç¨‹" class="tocSidebar-link" style="padding-left:0.9rem;font-weight:500;">çº¿ç¨‹</a><ul class="tocSidebar-sub-headers"><li class="tocSidebar-sub-header"><a href="/docs.advanced.way/java/hc/%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#å¹¶å‘å’Œå¹¶è¡Œ" class="tocSidebar-link" style="padding-left:0.8rem;font-weight:400;">å¹¶å‘å’Œå¹¶è¡Œ</a></li><li class="tocSidebar-sub-header"><a href="/docs.advanced.way/java/hc/%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#çº¿ç¨‹çŠ¶æ€" class="tocSidebar-link" style="padding-left:0.8rem;font-weight:400;">çº¿ç¨‹çŠ¶æ€</a></li><li class="tocSidebar-sub-header"><a href="/docs.advanced.way/java/hc/%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#åˆ›å»ºçº¿ç¨‹" class="tocSidebar-link" style="padding-left:0.8rem;font-weight:400;">åˆ›å»ºçº¿ç¨‹</a></li><li class="tocSidebar-sub-header"><a href="/docs.advanced.way/java/hc/%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#çº¿ç¨‹ç®¡ç†" class="tocSidebar-link" style="padding-left:0.8rem;font-weight:400;">çº¿ç¨‹ç®¡ç†</a></li><li class="tocSidebar-sub-header"><a href="/docs.advanced.way/java/hc/%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#çº¿ç¨‹è°ƒåº¦" class="tocSidebar-link" style="padding-left:0.8rem;font-weight:400;">çº¿ç¨‹è°ƒåº¦</a></li><li class="tocSidebar-sub-header"><a href="/docs.advanced.way/java/hc/%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#çº¿ç¨‹åŒæ­¥" class="tocSidebar-link" style="padding-left:0.8rem;font-weight:400;">çº¿ç¨‹åŒæ­¥</a></li><li class="tocSidebar-sub-header"><a href="/docs.advanced.way/java/hc/%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#çº¿ç¨‹é€šä¿¡" class="tocSidebar-link" style="padding-left:0.8rem;font-weight:400;">çº¿ç¨‹é€šä¿¡</a></li></ul></li><li class="tocSidebar-sub-header"><a href="/docs.advanced.way/java/hc/%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#çº¿ç¨‹æ± " class="tocSidebar-link" style="padding-left:0.9rem;font-weight:500;">çº¿ç¨‹æ± </a><ul class="tocSidebar-sub-headers"><li class="tocSidebar-sub-header"><a href="/docs.advanced.way/java/hc/%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#å†…ç½®çº¿ç¨‹æ± " class="tocSidebar-link" style="padding-left:0.8rem;font-weight:400;">å†…ç½®çº¿ç¨‹æ± </a></li><li class="tocSidebar-sub-header"><a href="/docs.advanced.way/java/hc/%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#çº¿ç¨‹æ± å‚æ•°" class="tocSidebar-link" style="padding-left:0.8rem;font-weight:400;">çº¿ç¨‹æ± å‚æ•°</a></li><li class="tocSidebar-sub-header"><a href="/docs.advanced.way/java/hc/%E5%A4%9A%E7%BA%BF%E7%A8%8B.html#æ­»é”" class="tocSidebar-link" style="padding-left:0.8rem;font-weight:400;">æ­»é”</a></li></ul></li></ul></aside></div><div class="global-ui"><!----></div></div>
    <script src="/docs.advanced.way/assets/js/app.dccd45fc.js" defer></script><script src="/docs.advanced.way/assets/js/6.9e0d7fea.js" defer></script><script src="/docs.advanced.way/assets/js/2.714d8455.js" defer></script><script src="/docs.advanced.way/assets/js/11.dd654c6c.js" defer></script>
  </body>
</html>
