<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Session | è¿›é˜¶ä¹‹è·¯</title>
    <meta name="generator" content="VuePress 1.8.0">
    
    <meta name="description" content="æ¶æ„å¸ˆ">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/docs.advanced.way/assets/css/0.styles.b15a9a47.css" as="style"><link rel="preload" href="/docs.advanced.way/assets/js/app.f5089147.js" as="script"><link rel="preload" href="/docs.advanced.way/assets/js/6.9e0d7fea.js" as="script"><link rel="preload" href="/docs.advanced.way/assets/js/2.714d8455.js" as="script"><link rel="preload" href="/docs.advanced.way/assets/js/17.1a6da635.js" as="script"><link rel="prefetch" href="/docs.advanced.way/assets/js/10.acc2626c.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/100.0752ba91.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/101.bba10006.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/102.4483f47f.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/103.37fa0d2f.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/104.c4dfce28.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/105.3505e336.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/106.adf2b24d.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/107.2dac3166.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/108.cc6e5ce6.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/109.2d6943ec.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/11.042133e0.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/110.14b5ee85.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/111.2163731b.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/112.e34e1b1c.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/113.d5a8c8b3.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/114.dbffc9ac.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/115.0a381a84.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/116.6bda5e3b.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/117.712f91e9.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/118.5ad74d6d.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/119.0c5bc4b9.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/12.dd39c1a5.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/120.e26e292d.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/121.1859b6ec.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/122.2cf377cd.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/123.92289d58.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/124.e87bf962.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/125.28670b44.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/126.1009dd8f.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/127.167d40ff.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/128.74e2014c.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/129.f67a0fdf.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/13.99a89149.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/130.ed79cc51.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/131.d306dc1a.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/132.79183d30.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/133.20cf4349.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/134.e2940dba.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/135.4d2fd228.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/136.7e729a84.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/137.2de06305.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/138.41494136.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/139.0e50835d.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/14.79993b97.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/140.41495434.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/141.e5da109f.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/142.74c4703d.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/143.b23cb2e5.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/144.558697e5.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/145.96578d22.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/146.3ceb18d0.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/147.fe004fc3.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/148.2dd8b27d.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/149.16e46ad9.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/15.fef4aed8.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/150.690d3b3a.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/151.a2359d00.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/152.7ae2b91f.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/153.b430588c.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/154.d0e5cf4a.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/155.85618429.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/156.abe226a5.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/157.1175ebe0.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/158.fe6aa879.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/159.71a503ea.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/16.f067f3dd.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/160.ec38a62e.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/161.2987b7f2.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/162.f32b5c1b.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/163.2f4dcde1.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/164.74cce723.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/165.f62a894a.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/166.e668e1be.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/167.6a3b9ea5.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/168.28aafb3d.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/169.4085a76d.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/170.cdf81323.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/171.eaae675a.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/172.1a61a8a2.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/173.6aaadd63.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/174.705ad6bf.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/175.1a923ef7.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/176.38d2cfba.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/177.62974e7d.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/178.b6020185.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/179.61252005.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/18.827c9d3e.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/180.c9679b04.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/181.8502fda5.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/182.27746a81.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/183.005a8d75.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/184.d719917f.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/185.3a2edb15.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/186.c80be746.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/187.2388c6e5.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/188.e0d41d52.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/189.cc384f72.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/19.08c23395.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/190.fbad00ec.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/191.29b2f9ff.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/192.3d154ad0.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/193.ffdee547.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/194.ac129128.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/195.9377c626.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/20.71cbfebe.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/21.798c18d8.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/22.b7fecb86.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/23.38ae7fef.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/24.740c5651.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/25.d163b418.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/26.fdf9806a.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/27.39960cd2.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/28.f3ba7e15.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/29.d9015c7e.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/3.f8f819e8.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/30.b1c61179.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/31.fbc750b4.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/32.895918de.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/33.c656f5df.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/34.b4bcd4c9.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/35.1a7558dc.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/36.d37b6d70.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/37.e36b99c4.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/38.53d0c795.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/39.c54b9760.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/4.8fc62bfa.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/40.8128d206.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/41.c8c6b234.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/42.307d9038.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/43.acea0318.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/44.9c0834ad.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/45.8a650359.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/46.74094106.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/47.967af4f1.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/48.df195a86.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/49.ff49ad48.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/5.e304aac5.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/50.ade520b7.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/51.31693985.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/52.a63cbc70.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/53.26128739.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/54.83c67cac.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/55.e96c0870.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/56.57503aa6.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/57.7e84f498.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/58.2732de09.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/59.642c8330.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/60.a5cfdff1.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/61.ef359e76.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/62.cd018c1a.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/63.2bbfdf6c.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/64.ca66d8b6.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/65.db3ec660.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/66.72584581.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/67.2f5ba8ff.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/68.35df45da.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/69.eafcfdc5.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/7.e550eb99.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/70.76af7c2c.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/71.43d09372.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/72.630555f1.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/73.b7b1cece.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/74.d50a279e.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/75.f8145843.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/76.30e0c0f0.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/77.4b69945a.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/78.cde8aed4.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/79.94a70bac.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/8.3e93b4fc.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/80.22af51b8.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/81.414cfd93.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/82.04226b20.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/83.ea571be3.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/84.d878f353.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/85.1d57ce13.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/86.b4b95f7b.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/87.5a25befe.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/88.b1010cfe.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/89.2732897e.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/9.519c44a4.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/90.febb7cd4.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/91.2fc8e45c.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/92.b32c4130.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/93.19f70a54.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/94.eda0711b.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/95.772afcc2.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/96.5dd10cd9.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/97.c9dadcf1.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/98.fa49c626.js"><link rel="prefetch" href="/docs.advanced.way/assets/js/99.fd9fae4c.js">
    <link rel="stylesheet" href="/docs.advanced.way/assets/css/0.styles.b15a9a47.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/docs.advanced.way/" class="home-link router-link-active"><!----> <span class="site-name">è¿›é˜¶ä¹‹è·¯</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/docs.advanced.way/java/" class="nav-link">
  â˜•ï¸Java
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="å¸¸ç”¨æ¡†æ¶" class="dropdown-title"><span class="title">å¸¸ç”¨æ¡†æ¶</span> <span class="arrow down"></span></button> <button type="button" aria-label="å¸¸ç”¨æ¡†æ¶" class="mobile-dropdown-title"><span class="title">å¸¸ç”¨æ¡†æ¶</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs.advanced.way/framework/spring/" class="nav-link router-link-active">
  Spring
</a></li><li class="dropdown-item"><!----> <a href="/docs.advanced.way/framework/mybatis/" class="nav-link">
  Mybatis
</a></li><li class="dropdown-item"><!----> <a href="/docs.advanced.way/framework/auth/" class="nav-link">
  æƒé™ç®¡ç†
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ä¸­é—´ä»¶" class="dropdown-title"><span class="title">ä¸­é—´ä»¶</span> <span class="arrow down"></span></button> <button type="button" aria-label="ä¸­é—´ä»¶" class="mobile-dropdown-title"><span class="title">ä¸­é—´ä»¶</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs.advanced.way/middleware/distributed/" class="nav-link">
  åˆ†å¸ƒå¼
</a></li><li class="dropdown-item"><!----> <a href="/docs.advanced.way/middleware/tranctional/" class="nav-link">
  äº‹åŠ¡
</a></li><li class="dropdown-item"><!----> <a href="/docs.advanced.way/middleware/servicemesh/" class="nav-link">
  æœåŠ¡ç½‘æ ¼
</a></li><li class="dropdown-item"><!----> <a href="/docs.advanced.way/middleware/mq/" class="nav-link">
  æ¶ˆæ¯é˜Ÿåˆ—
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="äº‘åŸç”Ÿ" class="dropdown-title"><span class="title">äº‘åŸç”Ÿ</span> <span class="arrow down"></span></button> <button type="button" aria-label="äº‘åŸç”Ÿ" class="mobile-dropdown-title"><span class="title">äº‘åŸç”Ÿ</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs.advanced.way/cloud/docker/" class="nav-link">
  Dockerå®¹å™¨
</a></li><li class="dropdown-item"><!----> <a href="/docs.advanced.way/cloud/k8s/" class="nav-link">
  Kubernetes
</a></li><li class="dropdown-item"><!----> <a href="/docs.advanced.way/cloud/serverless/" class="nav-link">
  Serverless
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="æœåŠ¡å™¨" class="dropdown-title"><span class="title">æœåŠ¡å™¨</span> <span class="arrow down"></span></button> <button type="button" aria-label="æœåŠ¡å™¨" class="mobile-dropdown-title"><span class="title">æœåŠ¡å™¨</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs.advanced.way/linux/" class="nav-link">
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/docs.advanced.way/cache/" class="nav-link">
  ç¼“å­˜
</a></li><li class="dropdown-item"><!----> <a href="/docs.advanced.way/db/" class="nav-link">
  æ•°æ®åº“
</a></li><li class="dropdown-item"><!----> <a href="/docs.advanced.way/cs/" class="nav-link">
  è®¡ç®—æœºç³»ç»Ÿ
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ç¼–ç å®è·µ" class="dropdown-title"><span class="title">ç¼–ç å®è·µ</span> <span class="arrow down"></span></button> <button type="button" aria-label="ç¼–ç å®è·µ" class="mobile-dropdown-title"><span class="title">ç¼–ç å®è·µ</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs.advanced.way/algorithm/" class="nav-link">
  ç®—æ³•/æ•°æ®ç»“æ„
</a></li><li class="dropdown-item"><!----> <a href="/docs.advanced.way/patterns/" class="nav-link">
  è®¾è®¡æ¨¡å¼
</a></li><li class="dropdown-item"><!----> <a href="/docs.advanced.way/architecture/" class="nav-link">
  æ¶æ„è®¾è®¡
</a></li><li class="dropdown-item"><!----> <a href="/docs.advanced.way/job/" class="nav-link">
  é¢è¯•
</a></li><li class="dropdown-item"><!----> <a href="/docs.advanced.way/memo/" class="nav-link">
  å¤‡å¿˜
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="å°ç™¾ç§‘" class="dropdown-title"><span class="title">å°ç™¾ç§‘</span> <span class="arrow down"></span></button> <button type="button" aria-label="å°ç™¾ç§‘" class="mobile-dropdown-title"><span class="title">å°ç™¾ç§‘</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs.advanced.way/cyclopedia/classnotes/" class="nav-link">
  è¯¾å ‚ç¬”è®°
</a></li><li class="dropdown-item"><!----> <a href="/docs.advanced.way/cyclopedia/chinese/" class="nav-link">
  å¤§ä¸­å›½ğŸ‡¨ğŸ‡³
</a></li></ul></div></div> <a href="https://github.com/wangwei461/docs.advanced.way.git" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/docs.advanced.way/java/" class="nav-link">
  â˜•ï¸Java
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="å¸¸ç”¨æ¡†æ¶" class="dropdown-title"><span class="title">å¸¸ç”¨æ¡†æ¶</span> <span class="arrow down"></span></button> <button type="button" aria-label="å¸¸ç”¨æ¡†æ¶" class="mobile-dropdown-title"><span class="title">å¸¸ç”¨æ¡†æ¶</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs.advanced.way/framework/spring/" class="nav-link router-link-active">
  Spring
</a></li><li class="dropdown-item"><!----> <a href="/docs.advanced.way/framework/mybatis/" class="nav-link">
  Mybatis
</a></li><li class="dropdown-item"><!----> <a href="/docs.advanced.way/framework/auth/" class="nav-link">
  æƒé™ç®¡ç†
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ä¸­é—´ä»¶" class="dropdown-title"><span class="title">ä¸­é—´ä»¶</span> <span class="arrow down"></span></button> <button type="button" aria-label="ä¸­é—´ä»¶" class="mobile-dropdown-title"><span class="title">ä¸­é—´ä»¶</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs.advanced.way/middleware/distributed/" class="nav-link">
  åˆ†å¸ƒå¼
</a></li><li class="dropdown-item"><!----> <a href="/docs.advanced.way/middleware/tranctional/" class="nav-link">
  äº‹åŠ¡
</a></li><li class="dropdown-item"><!----> <a href="/docs.advanced.way/middleware/servicemesh/" class="nav-link">
  æœåŠ¡ç½‘æ ¼
</a></li><li class="dropdown-item"><!----> <a href="/docs.advanced.way/middleware/mq/" class="nav-link">
  æ¶ˆæ¯é˜Ÿåˆ—
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="äº‘åŸç”Ÿ" class="dropdown-title"><span class="title">äº‘åŸç”Ÿ</span> <span class="arrow down"></span></button> <button type="button" aria-label="äº‘åŸç”Ÿ" class="mobile-dropdown-title"><span class="title">äº‘åŸç”Ÿ</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs.advanced.way/cloud/docker/" class="nav-link">
  Dockerå®¹å™¨
</a></li><li class="dropdown-item"><!----> <a href="/docs.advanced.way/cloud/k8s/" class="nav-link">
  Kubernetes
</a></li><li class="dropdown-item"><!----> <a href="/docs.advanced.way/cloud/serverless/" class="nav-link">
  Serverless
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="æœåŠ¡å™¨" class="dropdown-title"><span class="title">æœåŠ¡å™¨</span> <span class="arrow down"></span></button> <button type="button" aria-label="æœåŠ¡å™¨" class="mobile-dropdown-title"><span class="title">æœåŠ¡å™¨</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs.advanced.way/linux/" class="nav-link">
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/docs.advanced.way/cache/" class="nav-link">
  ç¼“å­˜
</a></li><li class="dropdown-item"><!----> <a href="/docs.advanced.way/db/" class="nav-link">
  æ•°æ®åº“
</a></li><li class="dropdown-item"><!----> <a href="/docs.advanced.way/cs/" class="nav-link">
  è®¡ç®—æœºç³»ç»Ÿ
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ç¼–ç å®è·µ" class="dropdown-title"><span class="title">ç¼–ç å®è·µ</span> <span class="arrow down"></span></button> <button type="button" aria-label="ç¼–ç å®è·µ" class="mobile-dropdown-title"><span class="title">ç¼–ç å®è·µ</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs.advanced.way/algorithm/" class="nav-link">
  ç®—æ³•/æ•°æ®ç»“æ„
</a></li><li class="dropdown-item"><!----> <a href="/docs.advanced.way/patterns/" class="nav-link">
  è®¾è®¡æ¨¡å¼
</a></li><li class="dropdown-item"><!----> <a href="/docs.advanced.way/architecture/" class="nav-link">
  æ¶æ„è®¾è®¡
</a></li><li class="dropdown-item"><!----> <a href="/docs.advanced.way/job/" class="nav-link">
  é¢è¯•
</a></li><li class="dropdown-item"><!----> <a href="/docs.advanced.way/memo/" class="nav-link">
  å¤‡å¿˜
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="å°ç™¾ç§‘" class="dropdown-title"><span class="title">å°ç™¾ç§‘</span> <span class="arrow down"></span></button> <button type="button" aria-label="å°ç™¾ç§‘" class="mobile-dropdown-title"><span class="title">å°ç™¾ç§‘</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs.advanced.way/cyclopedia/classnotes/" class="nav-link">
  è¯¾å ‚ç¬”è®°
</a></li><li class="dropdown-item"><!----> <a href="/docs.advanced.way/cyclopedia/chinese/" class="nav-link">
  å¤§ä¸­å›½ğŸ‡¨ğŸ‡³
</a></li></ul></div></div> <a href="https://github.com/wangwei461/docs.advanced.way.git" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Spring</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Spring MVC</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs.advanced.way/framework/spring/springmvc/ç®€ä»‹.html" class="sidebar-link">ç®€ä»‹</a></li><li><a href="/docs.advanced.way/framework/spring/springmvc/æ ¸å¿ƒç»„ä»¶.html" class="sidebar-link">æ ¸å¿ƒç»„ä»¶</a></li><li><a href="/docs.advanced.way/framework/spring/springmvc/Servlet.html" class="sidebar-link">Servlet</a></li><li><a href="/docs.advanced.way/framework/spring/springmvc/Session.html" aria-current="page" class="active sidebar-link">Session</a></li><li><a href="/docs.advanced.way/framework/spring/springmvc/DispatcherServlet.html" class="sidebar-link">DispatcherServlet</a></li><li><a href="/docs.advanced.way/framework/spring/springmvc/RequestMapping.html" class="sidebar-link">@RequestMapping</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Spring JMS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Spring Boot</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="session-cookies"><a href="#session-cookies" class="header-anchor">#</a> Session/Cookies</h2> <ul><li>session åœ¨æœåŠ¡å™¨ç«¯ï¼Œcookie åœ¨å®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰</li> <li>session é»˜è®¤è¢«å­˜åœ¨åœ¨æœåŠ¡å™¨çš„ä¸€ä¸ªæ–‡ä»¶é‡Œï¼ˆä¸æ˜¯å†…å­˜ï¼‰</li> <li>session çš„è¿è¡Œä¾èµ– session idï¼Œè€Œ session id æ˜¯å­˜åœ¨ cookie ä¸­çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæµè§ˆå™¨ç¦ç”¨äº† cookie ï¼ŒåŒæ—¶ session ä¹Ÿä¼šå¤±æ•ˆï¼ˆä½†æ˜¯å¯ä»¥é€šè¿‡å…¶å®ƒæ–¹å¼å®ç°ï¼Œæ¯”å¦‚åœ¨ url ä¸­ä¼ é€’ session_idï¼‰</li> <li>session å¯ä»¥æ”¾åœ¨ æ–‡ä»¶ã€æ•°æ®åº“ã€æˆ–å†…å­˜ä¸­éƒ½å¯ä»¥ã€‚</li> <li>ç”¨æˆ·éªŒè¯è¿™ç§åœºåˆä¸€èˆ¬ä¼šç”¨ session</li></ul> <h3 id="session"><a href="#session" class="header-anchor">#</a> Session</h3> <p>sessionæœºåˆ¶æ˜¯ä¸€ç§æœåŠ¡å™¨ç«¯çš„æœºåˆ¶ï¼ŒæœåŠ¡å™¨ä½¿ç”¨ä¸€ç§ç±»ä¼¼äºæ•£åˆ—è¡¨çš„ç»“æ„ï¼ˆä¹Ÿå¯èƒ½å°±æ˜¯ä½¿ç”¨æ•£åˆ—è¡¨ï¼‰æ¥ä¿å­˜ä¿¡æ¯</p> <p>å½“ç¨‹åºéœ€è¦ä¸ºæŸä¸ªå®¢æˆ·ç«¯çš„è¯·æ±‚åˆ›å»ºä¸€ä¸ªsessionæ—¶ï¼ŒæœåŠ¡å™¨é¦–å…ˆæ£€æŸ¥è¿™ä¸ªå®¢æˆ·ç«¯çš„è¯·æ±‚é‡Œæ˜¯å¦å·²åŒ…å«äº†ä¸€ä¸ªsessionæ ‡è¯†ï¼ˆç§°ä¸ºsession idï¼‰ï¼Œå¦‚æœå·²åŒ…å«åˆ™è¯´æ˜ä»¥å‰å·²ç»ä¸ºæ­¤å®¢æˆ·ç«¯åˆ›å»ºè¿‡sessionï¼ŒæœåŠ¡å™¨å°±æŒ‰ç…§session idæŠŠè¿™ä¸ªsessionæ£€ç´¢å‡ºæ¥ä½¿ç”¨ï¼ˆæ£€ç´¢ä¸åˆ°ï¼Œä¼šæ–°å»ºä¸€ä¸ªï¼‰ï¼Œå¦‚æœå®¢æˆ·ç«¯è¯·æ±‚ä¸åŒ…å«session idï¼Œåˆ™ä¸ºæ­¤å®¢æˆ·ç«¯åˆ›å»ºä¸€ä¸ªsessionå¹¶ä¸”ç”Ÿæˆä¸€ä¸ªä¸æ­¤sessionç›¸å…³è”çš„session idï¼Œsession idçš„å€¼åº”è¯¥æ˜¯ä¸€ä¸ªæ—¢ä¸ä¼šé‡å¤ï¼Œåˆä¸å®¹æ˜“è¢«æ‰¾åˆ°è§„å¾‹ä»¥ä»¿é€ çš„å­—ç¬¦ä¸²ï¼Œè¿™ä¸ªsession idå°†è¢«åœ¨æœ¬æ¬¡å“åº”ä¸­è¿”å›ç»™å®¢æˆ·ç«¯ä¿å­˜</p> <h3 id="servlet-å®šä¹‰çš„-httpsession"><a href="#servlet-å®šä¹‰çš„-httpsession" class="header-anchor">#</a> servlet å®šä¹‰çš„ HttpSession</h3> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">HttpSession</span> <span class="token punctuation">{</span>
    <span class="token comment">// Session åˆ›å»ºæ—¶é—´æˆ³</span>
    <span class="token keyword">public</span> <span class="token keyword">long</span> <span class="token function">getCreationTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// Session Id</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// æœ€åä¸€æ¬¡è®¿é—®æ—¶é—´</span>
    <span class="token keyword">public</span> <span class="token keyword">long</span> <span class="token function">getLastAccessedTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">ServletContext</span> <span class="token function">getServletContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// è·å–å’Œè®¾ç½®æœ€å¤§å­˜æ´»æ—¶é—´</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setMaxInactiveInterval</span><span class="token punctuation">(</span><span class="token keyword">int</span> interval<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getMaxInactiveInterval</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// å°†sessionè®¾ç½®ä¸ºå¤±æ•ˆ</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">invalidate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isNew</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="tomcatå®ç°æ–¹å¼"><a href="#tomcatå®ç°æ–¹å¼" class="header-anchor">#</a> Tomcatå®ç°æ–¹å¼</h2> <h3 id="æ ¸å¿ƒç±»"><a href="#æ ¸å¿ƒç±»" class="header-anchor">#</a> æ ¸å¿ƒç±»</h3> <h4 id="standardsession"><a href="#standardsession" class="header-anchor">#</a> StandardSession</h4> <p><img src="/docs.advanced.way/assets/img/StandardSession.286f37e4.png" alt=""></p> <p>é»˜è®¤çš„sessionçš„ç±»ï¼Œæ˜¯å¯¹sessionçš„ç³»ç»ŸæŠ½è±¡</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StandardSession</span> <span class="token keyword">implements</span> <span class="token class-name">HttpSession</span><span class="token punctuation">,</span> <span class="token class-name">Session</span><span class="token punctuation">,</span> <span class="token class-name">Serializable</span> <span class="token punctuation">{</span>

    <span class="token keyword">protected</span> <span class="token keyword">long</span> creationTime <span class="token operator">=</span> <span class="token number">0L</span><span class="token punctuation">;</span>

    <span class="token comment">// å­˜å‚¨sessionçš„æ•°æ®ç»“æ„</span>
    <span class="token keyword">protected</span> <span class="token class-name">ConcurrentMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> attributes <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ConcurrentHashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// è·å– session å€¼</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isValidInternal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalStateException</span>
                <span class="token punctuation">(</span>sm<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">&quot;standardSession.getAttribute.ise&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>name <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

        <span class="token comment">// ä» ConcurrentMap å–å‡ºå€¼</span>
        <span class="token keyword">return</span> attributes<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="standardmanager"><a href="#standardmanager" class="header-anchor">#</a> StandardManager</h4> <p><img src="/docs.advanced.way/assets/img/StandardManager.f48cb9e6.png" alt=""></p> <p>é»˜è®¤çš„sessionç®¡ç†ç±»ï¼Œç®¡ç†sessionçš„åˆ›å»ºã€åŠ è½½ã€æŒä¹…åŒ–ç­‰</p> <h3 id="åˆ›å»ºsessionè¿‡ç¨‹"><a href="#åˆ›å»ºsessionè¿‡ç¨‹" class="header-anchor">#</a> åˆ›å»ºSessionè¿‡ç¨‹</h3> <h4 id="æ¡ˆä¾‹"><a href="#æ¡ˆä¾‹" class="header-anchor">#</a> æ¡ˆä¾‹</h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/getSession&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// get</span>
    <span class="token class-name">HttpSession</span> session <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>session<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">String</span> sessionKey <span class="token operator">=</span> <span class="token string">&quot;a&quot;</span><span class="token punctuation">;</span>
    session<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span>sessionKey<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>session<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span>sessionKey<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="requestfacade"><a href="#requestfacade" class="header-anchor">#</a> RequestFacade</h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RequestFacade</span> <span class="token keyword">implements</span> <span class="token class-name">HttpServletRequest</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">HttpSession</span> <span class="token function">getSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// è¯·æ±‚æ£€æŸ¥</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>request <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalStateException</span><span class="token punctuation">(</span>
                            sm<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">&quot;requestFacade.nullRequest&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> <span class="token function">getSession</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">HttpSession</span> <span class="token function">getSession</span><span class="token punctuation">(</span><span class="token keyword">boolean</span> create<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>request <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalStateException</span><span class="token punctuation">(</span>
                            sm<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">&quot;requestFacade.nullRequest&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">SecurityUtil</span><span class="token punctuation">.</span><span class="token function">isPackageProtectionEnabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token class-name">AccessController</span><span class="token punctuation">.</span><span class="token function">doPrivileged</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">GetSessionPrivilegedAction</span><span class="token punctuation">(</span>create<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token comment">// é»˜è®¤è¿›å…¥è¿™é‡Œ</span>
            <span class="token keyword">return</span> request<span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span>create<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="request"><a href="#request" class="header-anchor">#</a> Request</h4> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Request</span> <span class="token keyword">implements</span> <span class="token class-name">HttpServletRequest</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">HttpSession</span> <span class="token function">getSession</span><span class="token punctuation">(</span><span class="token keyword">boolean</span> create<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// è·å–æˆ–åˆ›å»ºSession</span>
        <span class="token class-name">Session</span> session <span class="token operator">=</span> <span class="token function">doGetSession</span><span class="token punctuation">(</span>create<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>session <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> session<span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">protected</span> <span class="token class-name">Session</span> <span class="token function">doGetSession</span><span class="token punctuation">(</span><span class="token keyword">boolean</span> create<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token comment">// There cannot be a session if no context has been assigned yet</span>
        <span class="token class-name">Context</span> context <span class="token operator">=</span> <span class="token function">getContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>context <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// å¦‚æœå½“å‰å­˜åœ¨ session ä¸”æœ‰æ•ˆ è¿”å›</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>session <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>session<span class="token punctuation">.</span><span class="token function">isValid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            session <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>session <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> session<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// å¦‚æœå­˜åœ¨ä¸”æœ‰æ•ˆï¼Œåˆ™è¿”å›æ‰€è¯·æ±‚çš„ä¼šè¯</span>
        <span class="token class-name">Manager</span> manager <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">getManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>manager <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>      <span class="token comment">// Sessions are not supported</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// å¦‚æœSessionId ä¸ä¸ºç©ºï¼Œä» manager æŸ¥æ‰¾</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>requestedSessionId <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                session <span class="token operator">=</span> manager<span class="token punctuation">.</span><span class="token function">findSession</span><span class="token punctuation">(</span>requestedSessionId<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>log<span class="token punctuation">.</span><span class="token function">isDebugEnabled</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span>sm<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">&quot;request.session.failed&quot;</span><span class="token punctuation">,</span> requestedSessionId<span class="token punctuation">,</span> e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>sm<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">&quot;request.session.failed&quot;</span><span class="token punctuation">,</span> requestedSessionId<span class="token punctuation">,</span> e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                session <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>session <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>session<span class="token punctuation">.</span><span class="token function">isValid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                session <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>session <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                session<span class="token punctuation">.</span><span class="token function">access</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> session<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// å¦‚æœè¯·æ±‚è€Œå“åº”æœªæäº¤ï¼Œåˆ™åˆ›å»ºä¸€ä¸ªæ–°ä¼šè¯</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>create<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">boolean</span> trackModesIncludesCookie <span class="token operator">=</span>
                context<span class="token punctuation">.</span><span class="token function">getServletContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getEffectiveSessionTrackingModes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token class-name">SessionTrackingMode</span><span class="token punctuation">.</span>COOKIE<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>trackModesIncludesCookie <span class="token operator">&amp;&amp;</span> response<span class="token punctuation">.</span><span class="token function">getResponse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">isCommitted</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalStateException</span><span class="token punctuation">(</span>sm<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">&quot;coyoteRequest.sessionCreateCommitted&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// Re-use session IDs provided by the client in very limited</span>
        <span class="token comment">// circumstances.</span>
        <span class="token class-name">String</span> sessionId <span class="token operator">=</span> <span class="token function">getRequestedSessionId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>requestedSessionSSL<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// If the session ID has been obtained from the SSL handshake then</span>
            <span class="token comment">// use it.</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span><span class="token function">getSessionCookiePath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token operator">&amp;&amp;</span> <span class="token function">isRequestedSessionIdFromCookie</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
             <span class="token comment">//æ­¤å¤„æ˜¯ä¸ºäº†è·¨æµè§ˆå™¨ç›¸åŒsessionIDçš„è®¿é—®</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>context<span class="token punctuation">.</span><span class="token function">getValidateClientProvidedNewSessionId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">boolean</span> found <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Container</span> container <span class="token operator">:</span> <span class="token function">getHost</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">findChildren</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token class-name">Manager</span> m <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Context</span><span class="token punctuation">)</span> container<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>m <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token keyword">try</span> <span class="token punctuation">{</span>
                            <span class="token keyword">if</span> <span class="token punctuation">(</span>m<span class="token punctuation">.</span><span class="token function">findSession</span><span class="token punctuation">(</span>sessionId<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                                found <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
                                <span class="token keyword">break</span><span class="token punctuation">;</span>
                            <span class="token punctuation">}</span>
                        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                            <span class="token comment">// Ignore. Problems with this manager will be</span>
                            <span class="token comment">// handled elsewhere.</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>found<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    sessionId <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            sessionId <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// åˆ›å»º Session</span>
        session <span class="token operator">=</span> manager<span class="token punctuation">.</span><span class="token function">createSession</span><span class="token punctuation">(</span>sessionId<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Creating a new session cookie based on that session</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>session <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> trackModesIncludesCookie<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">Cookie</span> cookie <span class="token operator">=</span> <span class="token class-name">ApplicationSessionCookieConfig</span><span class="token punctuation">.</span><span class="token function">createSessionCookie</span><span class="token punctuation">(</span>
                    context<span class="token punctuation">,</span> session<span class="token punctuation">.</span><span class="token function">getIdInternal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">isSecure</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            response<span class="token punctuation">.</span><span class="token function">addSessionCookieInternal</span><span class="token punctuation">(</span>cookie<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>session <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// è®°å½•æœ€åæ–¹ä½æ—¶é—´</span>
        session<span class="token punctuation">.</span><span class="token function">access</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> session<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="managerbase"><a href="#managerbase" class="header-anchor">#</a> ManagerBase</h4> <p>ç®¡ç† session</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">ManagerBase</span> <span class="token keyword">extends</span> <span class="token class-name">LifecycleMBeanBase</span> <span class="token keyword">implements</span> <span class="token class-name">Manager</span> <span class="token punctuation">{</span>

    <span class="token comment">// ä¿å­˜ Session</span>
    <span class="token keyword">protected</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Session</span><span class="token punctuation">&gt;</span></span> sessions <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ConcurrentHashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Session</span> <span class="token function">createSession</span><span class="token punctuation">(</span><span class="token class-name">String</span> sessionId<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>maxActiveSessions <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token function">getActiveSessions</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> maxActiveSessions<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            rejectedSessions<span class="token operator">++</span><span class="token punctuation">;</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">TooManyActiveSessionsException</span><span class="token punctuation">(</span>
                    sm<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">&quot;managerBase.createSession.ise&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    maxActiveSessions<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// å›æ”¶æˆ–åˆ›å»ºä¼šè¯å®ä¾‹</span>
        <span class="token class-name">Session</span> session <span class="token operator">=</span> <span class="token function">createEmptySession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// åˆå§‹åŒ–æ–°ä¼šè¯çš„å±æ€§å¹¶è¿”å›å®ƒ</span>
        session<span class="token punctuation">.</span><span class="token function">setNew</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        session<span class="token punctuation">.</span><span class="token function">setValid</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        session<span class="token punctuation">.</span><span class="token function">setCreationTime</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        session<span class="token punctuation">.</span><span class="token function">setMaxInactiveInterval</span><span class="token punctuation">(</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSessionTimeout</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> id <span class="token operator">=</span> sessionId<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>id <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// ç”Ÿæˆä¸€ä¸ª sessionId</span>
            id <span class="token operator">=</span> <span class="token function">generateSessionId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

<span class="token comment">// è®¾ç½® Id å’Œ æŠŠ session æ”¾å…¥å®¹å™¨</span>
        session<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        sessionCounter<span class="token operator">++</span><span class="token punctuation">;</span>

        <span class="token class-name">SessionTiming</span> timing <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SessionTiming</span><span class="token punctuation">(</span>session<span class="token punctuation">.</span><span class="token function">getCreationTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">synchronized</span> <span class="token punctuation">(</span>sessionCreationTiming<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            sessionCreationTiming<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>timing<span class="token punctuation">)</span><span class="token punctuation">;</span>
            sessionCreationTiming<span class="token punctuation">.</span><span class="token function">poll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> session<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Session</span> <span class="token function">createEmptySession</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">getNewSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">protected</span> <span class="token class-name">StandardSession</span> <span class="token function">getNewSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">StandardSession</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">protected</span> <span class="token class-name">String</span> <span class="token function">generateSessionId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> result <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">do</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>result <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                duplicates<span class="token operator">++</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token comment">// ç”ŸæˆId</span>
            result <span class="token operator">=</span> sessionIdGenerator<span class="token punctuation">.</span><span class="token function">generateSessionId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å¾ªç¯é˜²æ­¢é‡å¤Id</span>
        <span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span>sessions<span class="token punctuation">.</span><span class="token function">containsKey</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// æ ¹æ® sessionId æŸ¥æ‰¾ Session</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Session</span> <span class="token function">findSession</span><span class="token punctuation">(</span><span class="token class-name">String</span> id<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>id <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> sessions<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">Session</span> session<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// æŠŠ session æ”¾å…¥å®¹å™¨ä¸­</span>
        sessions<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>session<span class="token punctuation">.</span><span class="token function">getIdInternal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> session<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// æ˜¯å¦è¶…è¿‡å®¹é‡æœ€å¤§é™åˆ¶</span>
        <span class="token keyword">int</span> size <span class="token operator">=</span> <span class="token function">getActiveSessions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span> size <span class="token operator">&gt;</span> maxActive <span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">synchronized</span><span class="token punctuation">(</span>maxActiveUpdateLock<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span> size <span class="token operator">&gt;</span> maxActive <span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    maxActive <span class="token operator">=</span> size<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h4 id="standardsession-2"><a href="#standardsession-2" class="header-anchor">#</a> StandardSession</h4> <p>Session key-value ç®¡ç†</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StandardSession</span> <span class="token keyword">implements</span> <span class="token class-name">HttpSession</span><span class="token punctuation">,</span> <span class="token class-name">Session</span><span class="token punctuation">,</span> <span class="token class-name">Serializable</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">StandardSession</span><span class="token punctuation">(</span><span class="token class-name">Manager</span> manager<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>manager <span class="token operator">=</span> manager<span class="token punctuation">;</span>

        <span class="token comment">// Initialize access count</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>ACTIVITY_CHECK<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            accessCount <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AtomicInteger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">access</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// è®°å½•è®¿é—®æ—¶é—´</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>thisAccessedTime <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>ACTIVITY_CHECK<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            accessCount<span class="token punctuation">.</span><span class="token function">incrementAndGet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setId</span><span class="token punctuation">(</span><span class="token class-name">String</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">setId</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setId</span><span class="token punctuation">(</span><span class="token class-name">String</span> id<span class="token punctuation">,</span> <span class="token keyword">boolean</span> notify<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>manager <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            manager<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>manager <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
            manager<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// ç›‘å¬äº‹ä»¶</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>notify<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">tellNew</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="è®¾ç½®-æŸ¥æ‰¾"><a href="#è®¾ç½®-æŸ¥æ‰¾" class="header-anchor">#</a> è®¾ç½®/æŸ¥æ‰¾</h3> <div class="language-java extra-class"><pre class="language-java"><code>
<span class="token comment">// session.getAttribute(sessionKey)</span>
<span class="token comment">// session.setAttribute(sessionKey, 1);</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StandardSession</span> <span class="token keyword">implements</span> <span class="token class-name">HttpSession</span><span class="token punctuation">,</span> <span class="token class-name">Session</span><span class="token punctuation">,</span> <span class="token class-name">Serializable</span> <span class="token punctuation">{</span>
    <span class="token comment">// ä¿å­˜ session key-value</span>
    <span class="token keyword">protected</span> <span class="token class-name">ConcurrentMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> attributes <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ConcurrentHashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isValidInternal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalStateException</span>
                <span class="token punctuation">(</span>sm<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">&quot;standardSession.getAttribute.ise&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>name <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

        <span class="token comment">// get</span>
        <span class="token keyword">return</span> attributes<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// è®¾ç½® Session</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token class-name">Object</span> value<span class="token punctuation">,</span> <span class="token keyword">boolean</span> notify<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token comment">// Name cannot be null</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>name <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span>
                    sm<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">&quot;standardSession.setAttribute.namenull&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// Null value is the same as removeAttribute()</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">removeAttribute</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// Validate our current state</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isValidInternal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalStateException</span><span class="token punctuation">(</span>
                    sm<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">&quot;standardSession.setAttribute.ise&quot;</span><span class="token punctuation">,</span> <span class="token function">getIdInternal</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token class-name">Context</span> context <span class="token operator">=</span> manager<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>context<span class="token punctuation">.</span><span class="token function">getDistributable</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token function">isAttributeDistributable</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> value<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token function">exclude</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span>sm<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">&quot;standardSession.setAttribute.iae&quot;</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// Construct an event with the new value</span>
        <span class="token class-name">HttpSessionBindingEvent</span> event <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

        <span class="token comment">// Call the valueBound() method if necessary</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>notify <span class="token operator">&amp;&amp;</span> value <span class="token keyword">instanceof</span> <span class="token class-name">HttpSessionBindingListener</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// Don't call any notification if replacing with the same value</span>
            <span class="token comment">// unless configured to do so</span>
            <span class="token class-name">Object</span> oldValue <span class="token operator">=</span> attributes<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token operator">!=</span> oldValue <span class="token operator">||</span> manager<span class="token punctuation">.</span><span class="token function">getNotifyBindingListenerOnUnchangedValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                event <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HttpSessionBindingEvent</span><span class="token punctuation">(</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">HttpSessionBindingListener</span><span class="token punctuation">)</span> value<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">valueBound</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> t<span class="token punctuation">)</span><span class="token punctuation">{</span>
                    manager<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>
                            sm<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">&quot;standardSession.bindingEvent&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> t<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// Replace or add this attribute</span>
        <span class="token class-name">Object</span> unbound <span class="token operator">=</span> attributes<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Call the valueUnbound() method if necessary</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>notify <span class="token operator">&amp;&amp;</span> unbound <span class="token keyword">instanceof</span> <span class="token class-name">HttpSessionBindingListener</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// Don't call any notification if replacing with the same value</span>
            <span class="token comment">// unless configured to do so</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>unbound <span class="token operator">!=</span> value <span class="token operator">||</span> manager<span class="token punctuation">.</span><span class="token function">getNotifyBindingListenerOnUnchangedValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">HttpSessionBindingListener</span><span class="token punctuation">)</span> unbound<span class="token punctuation">)</span><span class="token punctuation">.</span>valueUnbound
                        <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">HttpSessionBindingEvent</span><span class="token punctuation">(</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> t<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token class-name">ExceptionUtils</span><span class="token punctuation">.</span><span class="token function">handleThrowable</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    manager<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>error
                        <span class="token punctuation">(</span>sm<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">&quot;standardSession.bindingEvent&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> t<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>notify<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// Notify interested application event listeners</span>
        <span class="token class-name">Object</span> listeners<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">getApplicationEventListeners</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>listeners <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Object</span> o <span class="token operator">:</span> listeners<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>o <span class="token keyword">instanceof</span> <span class="token class-name">HttpSessionAttributeListener</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">continue</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token class-name">HttpSessionAttributeListener</span> listener <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">HttpSessionAttributeListener</span><span class="token punctuation">)</span> o<span class="token punctuation">;</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>unbound <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>unbound <span class="token operator">!=</span> value <span class="token operator">||</span> manager<span class="token punctuation">.</span><span class="token function">getNotifyAttributeListenerOnUnchangedValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        context<span class="token punctuation">.</span><span class="token function">fireContainerEvent</span><span class="token punctuation">(</span><span class="token string">&quot;beforeSessionAttributeReplaced&quot;</span><span class="token punctuation">,</span> listener<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>event <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                            event <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HttpSessionBindingEvent</span><span class="token punctuation">(</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token punctuation">,</span> unbound<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                        listener<span class="token punctuation">.</span><span class="token function">attributeReplaced</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        context<span class="token punctuation">.</span><span class="token function">fireContainerEvent</span><span class="token punctuation">(</span><span class="token string">&quot;afterSessionAttributeReplaced&quot;</span><span class="token punctuation">,</span> listener<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                    context<span class="token punctuation">.</span><span class="token function">fireContainerEvent</span><span class="token punctuation">(</span><span class="token string">&quot;beforeSessionAttributeAdded&quot;</span><span class="token punctuation">,</span> listener<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>event <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        event <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HttpSessionBindingEvent</span><span class="token punctuation">(</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> name<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    listener<span class="token punctuation">.</span><span class="token function">attributeAdded</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    context<span class="token punctuation">.</span><span class="token function">fireContainerEvent</span><span class="token punctuation">(</span><span class="token string">&quot;afterSessionAttributeAdded&quot;</span><span class="token punctuation">,</span> listener<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> t<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">ExceptionUtils</span><span class="token punctuation">.</span><span class="token function">handleThrowable</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">try</span> <span class="token punctuation">{</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>unbound <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>unbound <span class="token operator">!=</span> value <span class="token operator">||</span>
                                manager<span class="token punctuation">.</span><span class="token function">getNotifyAttributeListenerOnUnchangedValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                            context<span class="token punctuation">.</span><span class="token function">fireContainerEvent</span><span class="token punctuation">(</span><span class="token string">&quot;afterSessionAttributeReplaced&quot;</span><span class="token punctuation">,</span> listener<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                        context<span class="token punctuation">.</span><span class="token function">fireContainerEvent</span><span class="token punctuation">(</span><span class="token string">&quot;afterSessionAttributeAdded&quot;</span><span class="token punctuation">,</span> listener<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token comment">// Ignore</span>
                <span class="token punctuation">}</span>
                manager<span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>
                        sm<span class="token punctuation">.</span><span class="token function">getString</span><span class="token punctuation">(</span><span class="token string">&quot;standardSession.attributeEvent&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> t<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="session-å…±äº«"><a href="#session-å…±äº«" class="header-anchor">#</a> Session å…±äº«</h2> <h3 id="tomcat-é›†ç¾¤"><a href="#tomcat-é›†ç¾¤" class="header-anchor">#</a> Tomcat é›†ç¾¤</h3> <p>é…ç½®tomcat é›†ç¾¤ï¼Œè‡ªåŠ¨ä¼šå…±äº«session</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token comment">&lt;!-- ç¬¬1æ­¥ï¼šä¿®æ”¹server.xmlï¼Œåœ¨HostèŠ‚ç‚¹ä¸‹æ·»åŠ å¦‚ä¸‹ClusterèŠ‚ç‚¹ --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Cluster</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org.apache.catalina.ha.tcp.SimpleTcpCluster<span class="token punctuation">&quot;</span></span> <span class="token attr-name">channelSendOptions</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>8<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- åœ¨èŠ‚ç‚¹é—´æ‹·è´Session , é»˜è®¤all-to-allä¼šè¯å¤åˆ¶ --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Manager</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org.apache.catalina.ha.session.DeltaManager<span class="token punctuation">&quot;</span></span> 
                <span class="token attr-name">expireSessionsOnShutdown</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span> 
                <span class="token attr-name">notifyListenersOnReplication</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Channel</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org.apache.catalina.tribes.group.GroupChannel<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Membership</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org.apache.catalina.tribes.membership.McastService<span class="token punctuation">&quot;</span></span> <span class="token attr-name">address</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>228.0.0.4<span class="token punctuation">&quot;</span></span> 
                    <span class="token attr-name">port</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>45564<span class="token punctuation">&quot;</span></span> <span class="token attr-name">frequency</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>500<span class="token punctuation">&quot;</span></span> <span class="token attr-name">dropTime</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>3000<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>

        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Receiver</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org.apache.catalina.tribes.transport.nio.NioReceiver<span class="token punctuation">&quot;</span></span> 
                    <span class="token attr-name">address</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>auto<span class="token punctuation">&quot;</span></span> 
                    <span class="token attr-name">port</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>4000<span class="token punctuation">&quot;</span></span> 
                    <span class="token attr-name">autoBind</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>100<span class="token punctuation">&quot;</span></span> 
                    <span class="token attr-name">selectorTimeout</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>5000<span class="token punctuation">&quot;</span></span> 
                    <span class="token attr-name">maxThreads</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>6<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>

        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Sender</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org.apache.catalina.tribes.transport.ReplicationTransmitter<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Transport</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org.apache.catalina.tribes.transport.nio.PooledParallelSender<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Sender</span><span class="token punctuation">&gt;</span></span>

        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Interceptor</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org.apache.catalina.tribes.group.interceptors.TcpFailureDetector<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Interceptor</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org.apache.catalina.tribes.group.interceptors.MessageDispatchInterceptor<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Channel</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Valve</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org.apache.catalina.ha.tcp.ReplicationValve<span class="token punctuation">&quot;</span></span> <span class="token attr-name">filter</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Valve</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org.apache.catalina.ha.session.JvmRouteBinderValve<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Deployer</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org.apache.catalina.ha.deploy.FarmWarDeployer<span class="token punctuation">&quot;</span></span> <span class="token attr-name">tempDir</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/tmp/war-temp/<span class="token punctuation">&quot;</span></span> 
              <span class="token attr-name">deployDir</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/tmp/war-deploy/<span class="token punctuation">&quot;</span></span> <span class="token attr-name">watchDir</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/tmp/war-listen/<span class="token punctuation">&quot;</span></span> <span class="token attr-name">watchEnabled</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ClusterListener</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org.apache.catalina.ha.session.ClusterSessionListener<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Cluster</span><span class="token punctuation">&gt;</span></span>
 
<span class="token comment">&lt;!-- ç¬¬2æ­¥ï¼šåœ¨web.xmlä¸­æ·»åŠ å¦‚ä¸‹èŠ‚ç‚¹ --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>distributable</span><span class="token punctuation">/&gt;</span></span>
</code></pre></div><h4 id="æ­¥éª¤"><a href="#æ­¥éª¤" class="header-anchor">#</a> æ­¥éª¤</h4> <ol><li><p>ä¿®æ”¹ <code>server.xml</code>ï¼Œåœ¨ <code>Host</code> èŠ‚ç‚¹ä¸‹æ·»åŠ å¦‚ä¸‹ <code>Cluster</code> èŠ‚ç‚¹</p></li> <li><p>åœ¨ <code>web.xml</code> ä¸­æ·»åŠ  <code>&lt;distributable/&gt;</code></p></li></ol> <blockquote><p>cluster: [ËˆklÊŒstÉ™(r)] <br>
distributable: [di'stribjutÉ™bl]</p></blockquote> <h4 id="é…ç½®è¯´æ˜"><a href="#é…ç½®è¯´æ˜" class="header-anchor">#</a> é…ç½®è¯´æ˜</h4> <p><img src="/docs.advanced.way/assets/img/20181206164419260.c52ed98d.png" alt=""></p> <ul><li>Manager</li></ul> <p>ç”¨æ¥åœ¨èŠ‚ç‚¹é—´æ‹·è´Sessionï¼Œé»˜è®¤ä½¿ç”¨DeltaManagerï¼ŒDeltaManageré‡‡ç”¨çš„ä¸€ç§all-to-allçš„å·¥ä½œæ–¹å¼ï¼Œå³é›†ç¾¤ä¸­çš„èŠ‚ç‚¹ä¼šæŠŠSessionæ•°æ®å‘æ‰€æœ‰å…¶ä»–èŠ‚ç‚¹æ‹·è´ï¼Œè€Œä¸ç®¡å…¶ä»–èŠ‚ç‚¹æ˜¯å¦éƒ¨ç½²äº†å½“å‰åº”ç”¨ã€‚</p> <p>å½“é›†ç¾¤ä¸­çš„èŠ‚ç‚¹æ•°é‡å¾ˆå¤šå¹¶ä¸”éƒ¨ç½²ç€ä¸åŒåº”ç”¨æ—¶ï¼Œå¯ä»¥ä½¿ç”¨BackupManagerï¼ŒBackManagerä»…å‘éƒ¨ç½²äº†å½“å‰åº”ç”¨çš„èŠ‚ç‚¹æ‹·è´Session</p> <ul><li><p>Channel
è´Ÿè´£å¯¹tomcaté›†ç¾¤çš„IOå±‚è¿›è¡Œé…ç½®</p> <ul><li>Membership ç”¨äºå‘ç°é›†ç¾¤ä¸­çš„å…¶ä»–èŠ‚ç‚¹ï¼Œè¿™é‡Œçš„addressç”¨çš„æ˜¯ç»„æ’­åœ°å€ï¼ˆMulticast address</li> <li>Receiver ç”¨äºå„ä¸ªèŠ‚ç‚¹æ¥æ”¶å…¶ä»–èŠ‚ç‚¹å‘é€çš„æ•°æ®ï¼Œåœ¨é»˜è®¤é…ç½®ä¸‹tomcatä¼šä»4000-4100é—´ä¾æ¬¡é€‰å–ä¸€ä¸ªå¯ç”¨çš„ç«¯å£è¿›è¡Œæ¥æ”¶</li> <li>Sender ç”¨äºå‘å…¶ä»–èŠ‚ç‚¹å‘é€æ•°æ® PooledParallelSenderæ˜¯ä»tcpè¿æ¥æ± ä¸­è·å–è¿æ¥ï¼Œå¯ä»¥å®ç°å¹¶è¡Œå‘é€ï¼Œå³é›†ç¾¤ä¸­çš„å¤šä¸ªèŠ‚ç‚¹å¯ä»¥åŒæ—¶å‘å…¶ä»–æ‰€æœ‰èŠ‚ç‚¹å‘é€æ•°æ®è€Œäº’ä¸å½±å“</li></ul></li> <li><p>Valve</p></li></ul> <p>ç”¨äºåœ¨èŠ‚ç‚¹å‘å®¢æˆ·ç«¯å“åº”å‰è¿›è¡Œæ£€æµ‹æˆ–è¿›è¡ŒæŸäº›æ“ä½œ</p> <ul><li>Deployer</li></ul> <p>ç”¨äºé›†ç¾¤çš„farmåŠŸèƒ½ï¼Œç›‘æ§åº”ç”¨ä¸­æ–‡ä»¶çš„æ›´æ–°ï¼Œä»¥ä¿è¯é›†ç¾¤ä¸­æ‰€æœ‰èŠ‚ç‚¹åº”ç”¨çš„ä¸€è‡´æ€§</p> <ul><li>Listener</li></ul> <p>ç”¨äºè·Ÿè¸ªé›†ç¾¤ä¸­èŠ‚ç‚¹å‘å‡ºå’Œæ”¶åˆ°çš„æ•°æ®ï¼Œä¹Ÿæœ‰ç‚¹ç±»ä¼¼Valveçš„åŠŸèƒ½</p> <h3 id="spring-session"><a href="#spring-session" class="header-anchor">#</a> Spring Session</h3> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-data-redis<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.session<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-session-data-redis<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- @EnableRedisHttpSession --&gt;</span>
</code></pre></div><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="header-anchor">#</a> å‚è€ƒ</h2> <p><a href="https://blog.csdn.net/zengdeqing2012/article/details/50127139" target="_blank" rel="noopener noreferrer">tomcaté›†ç¾¤Clusterå®ç°åŸç†å‰–æ<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">æœ€åæ›´æ–°æ—¶é—´:</span> <span class="time">10/4/2020, 8:00:45 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      â†
      <a href="/docs.advanced.way/framework/spring/springmvc/Servlet.html" class="prev">
        Servlet
      </a></span> <span class="next"><a href="/docs.advanced.way/framework/spring/springmvc/DispatcherServlet.html">
        DispatcherServlet
      </a>
      â†’
    </span></p></div> </main> <aside class="tocSidebar"><div class="tocTitle">å½“å‰é¡µ</div> <ul class="tocSidebar-sub-headers"><li class="tocSidebar-sub-header"><a href="/docs.advanced.way/framework/spring/springmvc/Session.html#session-cookies" class="tocSidebar-link" style="padding-left:0.9rem;font-weight:500;">Session/Cookies</a><ul class="tocSidebar-sub-headers"><li class="tocSidebar-sub-header"><a href="/docs.advanced.way/framework/spring/springmvc/Session.html#session" class="tocSidebar-link" style="padding-left:0.8rem;font-weight:400;">Session</a></li><li class="tocSidebar-sub-header"><a href="/docs.advanced.way/framework/spring/springmvc/Session.html#servlet-å®šä¹‰çš„-httpsession" class="tocSidebar-link" style="padding-left:0.8rem;font-weight:400;">servlet å®šä¹‰çš„ HttpSession</a></li></ul></li><li class="tocSidebar-sub-header"><a href="/docs.advanced.way/framework/spring/springmvc/Session.html#tomcatå®ç°æ–¹å¼" class="tocSidebar-link" style="padding-left:0.9rem;font-weight:500;">Tomcatå®ç°æ–¹å¼</a><ul class="tocSidebar-sub-headers"><li class="tocSidebar-sub-header"><a href="/docs.advanced.way/framework/spring/springmvc/Session.html#æ ¸å¿ƒç±»" class="tocSidebar-link" style="padding-left:0.8rem;font-weight:400;">æ ¸å¿ƒç±»</a></li><li class="tocSidebar-sub-header"><a href="/docs.advanced.way/framework/spring/springmvc/Session.html#åˆ›å»ºsessionè¿‡ç¨‹" class="tocSidebar-link" style="padding-left:0.8rem;font-weight:400;">åˆ›å»ºSessionè¿‡ç¨‹</a></li><li class="tocSidebar-sub-header"><a href="/docs.advanced.way/framework/spring/springmvc/Session.html#è®¾ç½®-æŸ¥æ‰¾" class="tocSidebar-link" style="padding-left:0.8rem;font-weight:400;">è®¾ç½®/æŸ¥æ‰¾</a></li></ul></li><li class="tocSidebar-sub-header"><a href="/docs.advanced.way/framework/spring/springmvc/Session.html#session-å…±äº«" class="tocSidebar-link" style="padding-left:0.9rem;font-weight:500;">Session å…±äº«</a><ul class="tocSidebar-sub-headers"><li class="tocSidebar-sub-header"><a href="/docs.advanced.way/framework/spring/springmvc/Session.html#tomcat-é›†ç¾¤" class="tocSidebar-link" style="padding-left:0.8rem;font-weight:400;">Tomcat é›†ç¾¤</a></li><li class="tocSidebar-sub-header"><a href="/docs.advanced.way/framework/spring/springmvc/Session.html#spring-session" class="tocSidebar-link" style="padding-left:0.8rem;font-weight:400;">Spring Session</a></li></ul></li><li class="tocSidebar-sub-header"><a href="/docs.advanced.way/framework/spring/springmvc/Session.html#å‚è€ƒ" class="tocSidebar-link" style="padding-left:0.9rem;font-weight:500;">å‚è€ƒ</a></li></ul></aside></div><div class="global-ui"><!----></div></div>
    <script src="/docs.advanced.way/assets/js/app.f5089147.js" defer></script><script src="/docs.advanced.way/assets/js/6.9e0d7fea.js" defer></script><script src="/docs.advanced.way/assets/js/2.714d8455.js" defer></script><script src="/docs.advanced.way/assets/js/17.1a6da635.js" defer></script>
  </body>
</html>
